
R version 3.4.1 (2017-06-30) -- "Single Candle"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> library(car);
Loading required package: carData
> library(sqldf);
Loading required package: gsubfn
Loading required package: proto
Loading required package: RSQLite
> set.seed(22);
> 
> purchase=read.csv("party.csv")
> head(purchase,20)
    X particpate elaboration     prefood     pregas   prebank  preretail
1   7          0           0   3.1612892  2.4838696  48.77417  0.5645161
2  12          0           0   0.0000000  0.0000000  46.85483  0.3387096
3  14          0           0   7.5645142  0.9032254  67.51611  0.4516127
4  15          0           0   0.0000000  0.0000000 105.90320  0.0000000
5  18          0           0   0.1129032  0.0000000  26.75806  0.0000000
6  19          1           8   0.0000000 13.5483856  33.53226  0.1129032
7  24          1           8   3.1612892  0.0000000   0.00000  0.0000000
8  35          0           0   1.6935482  0.0000000  24.38708  0.2258064
9  39          0           0  11.7419281  0.0000000 131.87085  0.0000000
10 42          1          23 193.9676514 10.1612854  77.56451  0.3387096
11 44          0           0   4.4032249  9.7096710  76.77417  0.0000000
12 51          0           0  47.4193420  4.5161285  16.25806  3.5000000
13 52          0           0   2.8225803  0.0000000  37.82257  0.1129032
14 67          0           0   0.1129032  0.5645161 141.35474 21.1128998
15 68          1          17   0.5645161  0.3387096  98.67737  1.1290321
16 69          1          26  52.6128845  0.3387096  40.08063  6.6612892
17 75          1          26   5.3064499  0.0000000  49.45160  0.0000000
18 76          0           0  47.8709412  2.2580643  58.03226 21.3386993
19 77          1          40  12.3064499  0.2258064  50.01611  0.7903223
20 91          0           0   0.1129032  0.0000000  93.25806  0.0000000
     preother Rfreq mile1 mile2 mile3 mile4   basemile
1   0.0000000     0     4     3   166     4  54.983845
2  10.9516067     0    93     3    23     0  58.145144
3   0.6774192     0     0     0    84   177  77.112885
4  20.0967712     0     0     0   639     0 125.999969
5   0.1129032     0     0     0     0    59  26.983863
6   8.3548355     0     3     2   110     0  55.548381
7   0.3387096     0     0     1    12     2   3.499999
8   6.2096748     0   260     0    36     0  32.516114
9   0.0000000     0    15     2   426    33 143.612778
10  0.0000000     0   166   266   102    67 282.032161
11 22.9193420     0    37    22   376     9 113.806408
12  0.0000000     0    25    61    54    18  71.693527
13  0.0000000     0    79     1     1    12  40.758054
14 37.5967712     0   252   147    62    64 200.741827
15 22.2419281     0     7     2   174     0 122.951554
16  1.8064508     0   128     0   424    32 101.499962
17  7.1128998     0     1     8     0   116  61.870949
18  0.0000000     0    25   147    40    41 129.499962
19  3.6129017     0   204     5     0    11  66.951594
20  0.0000000     0    13     0    28     0  93.370960
> 
> purchase=sqldf("SELECT * FROM purchase WHERE basemile < 25000");
> attach(purchase)
> 
> 
> purchase$postTotal = mile1 + mile2 + mile3 + mile4;
> purchase$totalRatio = (purchase$postTotal)/(basemile);
> purchase$training = as.integer(runif(nrow(purchase))*5);
> 
> purchaseTraining = sqldf("SELECT * FROM purchase WHERE training < 4");
> purchaseValidation = sqldf("SELECT * FROM purchase WHERE training = 4");
> im1base=lm(log(mile1+1)~1,purchaseTraining)
> 
> im11=step(im1base, scope=~particpate+log(prefood+1)+I(log(prefood+1)^2)+particpate:log(prefood+1)+
+ log(prebank+1)+I(log(prebank+1)^2)+particpate:log(prebank+1)+
+ log(pregas+1)+I(log(pregas+1)^2)+particpate:log(pregas+1)+
+ log(preretail+1)+I(log(preretail+1)^2)+particpate:log(preretail+1)+
+ log(preother+1)+I(log(preother+1)^2)+particpate:log(preother+1)+
+ Rfreq+log(Rfreq+1)+1/Rfreq
+ , test="F", data=purchaseTraining)
Start:  AIC=11214.48
log(mile1 + 1) ~ 1

                          Df Sum of Sq   RSS     AIC   F value    Pr(>F)    
+ log(prefood + 1)         1    4106.6 26624  9798.1 1524.8264 < 2.2e-16 ***
+ I(log(prefood + 1)^2)    1    4050.0 26681  9819.1 1500.6278 < 2.2e-16 ***
+ log(prebank + 1)         1    3576.1 27155  9993.2 1301.9245 < 2.2e-16 ***
+ I(log(prebank + 1)^2)    1    3258.7 27472 10108.1 1172.6753 < 2.2e-16 ***
+ log(pregas + 1)          1    1305.1 29426 10787.4  438.4678 < 2.2e-16 ***
+ I(log(pregas + 1)^2)     1     946.0 29785 10907.3  313.9832 < 2.2e-16 ***
+ log(preother + 1)        1     726.9 30004 10979.8  239.5013 < 2.2e-16 ***
+ I(log(preother + 1)^2)   1     570.3 30161 11031.3  186.9271 < 2.2e-16 ***
+ log(preretail + 1)       1     505.3 30226 11052.5  165.2823 < 2.2e-16 ***
+ I(log(preretail + 1)^2)  1     193.4 30538 11154.0   62.6188 2.777e-15 ***
+ log(Rfreq + 1)           1      13.6 30717 11212.1    4.3732   0.03653 *  
+ Rfreq                    1       9.8 30721 11213.3    3.1657   0.07523 .  
+ particpate               1       9.8 30721 11213.3    3.1415   0.07636 .  
<none>                                 30731 11214.5                        
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=9798.12
log(mile1 + 1) ~ log(prefood + 1)

                          Df Sum of Sq   RSS     AIC   F value    Pr(>F)    
+ log(prebank + 1)         1    3084.1 23540  8582.8 1295.0798 < 2.2e-16 ***
+ I(log(prebank + 1)^2)    1    2699.7 23925  8742.9 1115.4578 < 2.2e-16 ***
+ log(pregas + 1)          1     899.3 25725  9460.4  345.5531 < 2.2e-16 ***
+ I(log(pregas + 1)^2)     1     663.8 25961  9550.5  252.7437 < 2.2e-16 ***
+ log(preother + 1)        1     453.1 26171  9630.4  171.1223 < 2.2e-16 ***
+ I(log(preother + 1)^2)   1     384.2 26240  9656.4  144.7246 < 2.2e-16 ***
+ log(preretail + 1)       1     248.8 26376  9707.3   93.2522 < 2.2e-16 ***
+ I(log(prefood + 1)^2)    1      90.0 26534  9766.6   33.5289 7.236e-09 ***
+ I(log(preretail + 1)^2)  1      88.4 26536  9767.2   32.9412 9.779e-09 ***
+ particpate               1       7.6 26617  9797.3    2.8401   0.09197 .  
<none>                                 26624  9798.1                        
+ log(Rfreq + 1)           1       3.5 26621  9798.8    1.3175   0.25108    
+ Rfreq                    1       0.5 26624  9799.9    0.1884   0.66423    
- log(prefood + 1)         1    4106.6 30731 11214.5 1524.8264 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8582.75
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(pregas + 1)          1     307.0 23233 8454.9  130.6194 < 2.2e-16 ***
+ I(log(pregas + 1)^2)     1     226.8 23314 8489.0   96.1583 < 2.2e-16 ***
+ log(preother + 1)        1     122.6 23418 8533.1   51.7328 6.820e-13 ***
+ I(log(preother + 1)^2)   1     101.3 23439 8542.1   42.7137 6.649e-11 ***
+ log(preretail + 1)       1      91.2 23449 8546.4   38.4444 5.859e-10 ***
+ I(log(prefood + 1)^2)    1      44.4 23496 8566.1   18.6837 1.558e-05 ***
+ I(log(preretail + 1)^2)  1      31.8 23508 8571.4   13.3808 0.0002555 ***
+ I(log(prebank + 1)^2)    1      16.2 23524 8578.0    6.7999 0.0091298 ** 
+ particpate               1      10.2 23530 8580.5    4.2949 0.0382534 *  
<none>                                 23540 8582.8                        
+ Rfreq                    1       1.5 23539 8584.1    0.6448 0.4219951    
+ log(Rfreq + 1)           1       0.0 23540 8584.7    0.0152 0.9019654    
- log(prebank + 1)         1    3084.1 26624 9798.1 1295.0798 < 2.2e-16 ***
- log(prefood + 1)         1    3614.6 27155 9993.2 1517.8254 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8454.94
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(preother + 1)        1      99.7 23134 8414.4   42.6037 7.032e-11 ***
+ I(log(preother + 1)^2)   1      85.0 23148 8420.7   36.2711 1.778e-09 ***
+ log(preretail + 1)       1      69.0 23164 8427.5   29.4190 5.968e-08 ***
+ I(log(prefood + 1)^2)    1      48.1 23185 8436.4   20.5013 6.029e-06 ***
+ I(log(prebank + 1)^2)    1      29.7 23204 8444.3   12.6315 0.0003811 ***
+ I(log(preretail + 1)^2)  1      23.4 23210 8447.0    9.9720 0.0015942 ** 
+ particpate               1      10.1 23223 8452.6    4.3164 0.0377735 *  
+ I(log(pregas + 1)^2)     1       8.6 23225 8453.3    3.6478 0.0561734 .  
<none>                                 23233 8454.9                        
+ Rfreq                    1       0.7 23232 8456.6    0.3005 0.5836062    
+ log(Rfreq + 1)           1       0.4 23233 8456.8    0.1513 0.6972942    
- log(pregas + 1)          1     307.0 23540 8582.8  130.6194 < 2.2e-16 ***
- log(prebank + 1)         1    2491.9 25725 9460.4 1060.1046 < 2.2e-16 ***
- log(prefood + 1)         1    3414.0 26647 9808.6 1452.4165 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8414.4
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(preretail + 1)       1      58.3 23075 8391.5   24.9629 5.945e-07 ***
+ I(log(prebank + 1)^2)    1      46.1 23087 8396.7   19.7450 8.945e-06 ***
+ I(log(prefood + 1)^2)    1      45.6 23088 8396.9   19.5065 1.013e-05 ***
+ I(log(preretail + 1)^2)  1      18.5 23115 8408.5    7.9148  0.004913 ** 
+ particpate               1       9.9 23124 8412.2    4.2302  0.039737 *  
+ I(log(pregas + 1)^2)     1       7.6 23126 8413.2    3.2337  0.072166 .  
<none>                                 23134 8414.4                        
+ Rfreq                    1       0.7 23133 8416.1    0.2829  0.594812    
+ I(log(preother + 1)^2)   1       0.4 23133 8416.2    0.1742  0.676378    
+ log(Rfreq + 1)           1       0.3 23133 8416.3    0.1280  0.720527    
- log(preother + 1)        1      99.7 23233 8454.9   42.6037 7.032e-11 ***
- log(pregas + 1)          1     284.2 23418 8533.1  121.4098 < 2.2e-16 ***
- log(prebank + 1)         1    2257.9 25391 9333.3  964.6082 < 2.2e-16 ***
- log(prefood + 1)         1    3311.5 26445 9735.3 1414.7204 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8391.46
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1) + log(preretail + 1)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ I(log(prebank + 1)^2)    1      50.0 23025 8372.0   21.4677 3.644e-06 ***
+ I(log(prefood + 1)^2)    1      46.6 23029 8373.5   20.0091 7.794e-06 ***
+ I(log(preretail + 1)^2)  1      32.0 23043 8379.7   13.7129 0.0002142 ***
+ particpate               1       7.8 23067 8390.1    3.3265 0.0682013 .  
+ I(log(pregas + 1)^2)     1       6.4 23069 8390.7    2.7333 0.0983047 .  
<none>                                 23075 8391.5                        
+ I(log(preother + 1)^2)   1       0.6 23075 8393.2    0.2701 0.6033052    
+ Rfreq                    1       0.5 23075 8393.2    0.2199 0.6391578    
+ log(Rfreq + 1)           1       0.3 23075 8393.3    0.1404 0.7078670    
- log(preretail + 1)       1      58.3 23134 8414.4   24.9629 5.945e-07 ***
- log(preother + 1)        1      89.1 23164 8427.5   38.1403 6.843e-10 ***
- log(pregas + 1)          1     265.7 23341 8502.6  113.7677 < 2.2e-16 ***
- log(prebank + 1)         1    2184.8 25260 9284.0  935.6337 < 2.2e-16 ***
- log(prefood + 1)         1    3209.8 26285 9677.3 1374.5962 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8372
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1) + log(preretail + 1) + I(log(prebank + 
    1)^2)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ I(log(prefood + 1)^2)    1      46.2 22979 8354.2   19.8465 8.484e-06 ***
+ I(log(preretail + 1)^2)  1      32.9 22992 8359.8   14.1518 0.0001696 ***
+ particpate               1       7.1 23018 8371.0    3.0390 0.0813179 .  
+ I(log(pregas + 1)^2)     1       5.6 23020 8371.6    2.3934 0.1218791    
<none>                                 23025 8372.0                        
+ I(log(preother + 1)^2)   1       1.3 23024 8373.5    0.5426 0.4613583    
+ log(Rfreq + 1)           1       0.5 23025 8373.8    0.2056 0.6502299    
+ Rfreq                    1       0.3 23025 8373.9    0.1232 0.7256063    
- I(log(prebank + 1)^2)    1      50.0 23075 8391.5   21.4677 3.644e-06 ***
- log(preretail + 1)       1      62.2 23087 8396.7   26.6859 2.440e-07 ***
- log(preother + 1)        1     105.2 23130 8415.1   45.1379 1.938e-11 ***
- log(pregas + 1)          1     280.7 23306 8489.8  120.4598 < 2.2e-16 ***
- log(prebank + 1)         1     438.6 23464 8556.6  188.2052 < 2.2e-16 ***
- log(prefood + 1)         1    3236.7 26262 9670.6 1388.9842 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8354.16
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1) + log(preretail + 1) + I(log(prebank + 
    1)^2) + I(log(prefood + 1)^2)

                          Df Sum of Sq   RSS    AIC  F value    Pr(>F)    
+ I(log(preretail + 1)^2)  1     33.47 22946 8341.7  14.4114 0.0001478 ***
+ particpate               1      5.57 22974 8353.8   2.3947 0.1217804    
+ I(log(pregas + 1)^2)     1      5.33 22974 8353.9   2.2914 0.1301280    
<none>                                 22979 8354.2                       
+ I(log(preother + 1)^2)   1      1.39 22978 8355.6   0.5966 0.4398935    
+ Rfreq                    1      0.67 22978 8355.9   0.2880 0.5915096    
+ log(Rfreq + 1)           1      0.20 22979 8356.1   0.0842 0.7717129    
- I(log(prefood + 1)^2)    1     46.16 23025 8372.0  19.8465 8.484e-06 ***
- I(log(prebank + 1)^2)    1     49.55 23029 8373.5  21.3050 3.967e-06 ***
- log(preretail + 1)       1     63.25 23042 8379.3  27.1959 1.876e-07 ***
- log(preother + 1)        1    102.42 23081 8396.1  44.0349 3.395e-11 ***
- log(prefood + 1)         1    156.34 23135 8419.2  67.2204 2.730e-16 ***
- log(pregas + 1)          1    284.16 23263 8473.7 122.1757 < 2.2e-16 ***
- log(prebank + 1)         1    432.75 23412 8536.6 186.0644 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8341.74
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1) + log(preretail + 1) + I(log(prebank + 
    1)^2) + I(log(prefood + 1)^2) + I(log(preretail + 1)^2)

                          Df Sum of Sq   RSS    AIC  F value    Pr(>F)    
+ particpate               1      5.44 22940 8341.4   2.3432 0.1258618    
+ I(log(pregas + 1)^2)     1      5.05 22940 8341.6   2.1726 0.1405240    
<none>                                 22946 8341.7                       
+ I(log(preother + 1)^2)   1      1.60 22944 8343.1   0.6882 0.4067846    
+ Rfreq                    1      0.63 22945 8343.5   0.2715 0.6023504    
+ log(Rfreq + 1)           1      0.21 22945 8343.6   0.0924 0.7612040    
- I(log(preretail + 1)^2)  1     33.47 22979 8354.2  14.4114 0.0001478 ***
- I(log(prefood + 1)^2)    1     46.70 22992 8359.8  20.1057 7.411e-06 ***
- I(log(prebank + 1)^2)    1     50.51 22996 8361.5  21.7449 3.155e-06 ***
- log(preretail + 1)       1     76.22 23022 8372.5  32.8173 1.042e-08 ***
- log(preother + 1)        1    100.68 23046 8383.0  43.3470 4.817e-11 ***
- log(prefood + 1)         1    153.16 23099 8405.5  65.9412 5.201e-16 ***
- log(pregas + 1)          1    275.96 23222 8458.0 118.8140 < 2.2e-16 ***
- log(prebank + 1)         1    430.98 23376 8523.7 185.5525 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8341.4
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1) + log(preretail + 1) + I(log(prebank + 
    1)^2) + I(log(prefood + 1)^2) + I(log(preretail + 1)^2) + 
    particpate

                                Df Sum of Sq   RSS    AIC  F value    Pr(>F)
+ particpate:log(preretail + 1)  1      6.18 22934 8340.7   2.6637  0.102694
+ I(log(pregas + 1)^2)           1      4.93 22935 8341.3   2.1241  0.145031
<none>                                       22940 8341.4                   
- particpate                     1      5.44 22946 8341.7   2.3432  0.125862
+ I(log(preother + 1)^2)         1      1.88 22938 8342.6   0.8103  0.368048
+ particpate:log(prefood + 1)    1      1.54 22939 8342.7   0.6617  0.415996
+ Rfreq                          1      0.68 22939 8343.1   0.2921  0.588898
+ particpate:log(prebank + 1)    1      0.40 22940 8343.2   0.1740  0.676585
+ particpate:log(pregas + 1)     1      0.21 22940 8343.3   0.0884  0.766287
+ log(Rfreq + 1)                 1      0.18 22940 8343.3   0.0782  0.779823
+ particpate:log(preother + 1)   1      0.07 22940 8343.4   0.0319  0.858164
- I(log(preretail + 1)^2)        1     33.35 22974 8353.8  14.3587  0.000152
- I(log(prefood + 1)^2)          1     45.19 22985 8358.9  19.4601 1.038e-05
- I(log(prebank + 1)^2)          1     49.90 22990 8360.9  21.4890 3.604e-06
- log(preretail + 1)             1     75.12 23015 8371.7  32.3465 1.327e-08
- log(preother + 1)              1    100.59 23041 8382.7  43.3146 4.898e-11
- log(prefood + 1)               1    155.30 23095 8406.1  66.8707 3.256e-16
- log(pregas + 1)                1    276.04 23216 8457.7 118.8632 < 2.2e-16
- log(prebank + 1)               1    429.71 23370 8522.9 185.0315 < 2.2e-16
                                   
+ particpate:log(preretail + 1)    
+ I(log(pregas + 1)^2)             
<none>                             
- particpate                       
+ I(log(preother + 1)^2)           
+ particpate:log(prefood + 1)      
+ Rfreq                            
+ particpate:log(prebank + 1)      
+ particpate:log(pregas + 1)       
+ log(Rfreq + 1)                   
+ particpate:log(preother + 1)     
- I(log(preretail + 1)^2)       ***
- I(log(prefood + 1)^2)         ***
- I(log(prebank + 1)^2)         ***
- log(preretail + 1)            ***
- log(preother + 1)             ***
- log(prefood + 1)              ***
- log(pregas + 1)               ***
- log(prebank + 1)              ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8340.73
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1) + log(preretail + 1) + I(log(prebank + 
    1)^2) + I(log(prefood + 1)^2) + I(log(preretail + 1)^2) + 
    particpate + log(preretail + 1):particpate

                                Df Sum of Sq   RSS    AIC  F value    Pr(>F)
+ I(log(pregas + 1)^2)           1      4.84 22929 8340.6   2.0828    0.1490
<none>                                       22934 8340.7                   
- log(preretail + 1):particpate  1      6.18 22940 8341.4   2.6637    0.1027
+ particpate:log(prefood + 1)    1      2.30 22932 8341.7   0.9915    0.3194
+ I(log(preother + 1)^2)         1      2.01 22932 8341.9   0.8671    0.3518
+ particpate:log(prebank + 1)    1      0.90 22933 8342.3   0.3867    0.5340
+ Rfreq                          1      0.64 22933 8342.5   0.2735    0.6010
+ log(Rfreq + 1)                 1      0.21 22934 8342.6   0.0911    0.7628
+ particpate:log(pregas + 1)     1      0.03 22934 8342.7   0.0148    0.9031
+ particpate:log(preother + 1)   1      0.00 22934 8342.7   0.0001    0.9904
- I(log(preretail + 1)^2)        1     36.11 22970 8354.3  15.5495 8.093e-05
- I(log(prefood + 1)^2)          1     45.24 22979 8358.2  19.4855 1.024e-05
- I(log(prebank + 1)^2)          1     49.85 22984 8360.2  21.4708 3.639e-06
- log(preother + 1)              1    101.25 23035 8382.3  43.6073 4.220e-11
- log(prefood + 1)               1    155.36 23089 8405.5  66.9082 3.195e-16
- log(pregas + 1)                1    277.40 23211 8457.6 119.4673 < 2.2e-16
- log(prebank + 1)               1    429.78 23364 8522.3 185.0941 < 2.2e-16
                                   
+ I(log(pregas + 1)^2)             
<none>                             
- log(preretail + 1):particpate    
+ particpate:log(prefood + 1)      
+ I(log(preother + 1)^2)           
+ particpate:log(prebank + 1)      
+ Rfreq                            
+ log(Rfreq + 1)                   
+ particpate:log(pregas + 1)       
+ particpate:log(preother + 1)     
- I(log(preretail + 1)^2)       ***
- I(log(prefood + 1)^2)         ***
- I(log(prebank + 1)^2)         ***
- log(preother + 1)             ***
- log(prefood + 1)              ***
- log(pregas + 1)               ***
- log(prebank + 1)              ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8340.65
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1) + log(preretail + 1) + I(log(prebank + 
    1)^2) + I(log(prefood + 1)^2) + I(log(preretail + 1)^2) + 
    particpate + I(log(pregas + 1)^2) + log(preretail + 1):particpate

                                Df Sum of Sq   RSS    AIC  F value    Pr(>F)
<none>                                       22929 8340.6                   
- I(log(pregas + 1)^2)           1      4.84 22934 8340.7   2.0828    0.1490
- log(preretail + 1):particpate  1      6.09 22935 8341.3   2.6223    0.1054
+ particpate:log(prefood + 1)    1      2.27 22927 8341.7   0.9781    0.3227
+ I(log(preother + 1)^2)         1      2.02 22927 8341.8   0.8684    0.3514
+ particpate:log(prebank + 1)    1      0.99 22928 8342.2   0.4282    0.5129
+ Rfreq                          1      0.67 22928 8342.4   0.2888    0.5910
+ log(Rfreq + 1)                 1      0.19 22929 8342.6   0.0817    0.7750
+ particpate:log(pregas + 1)     1      0.04 22929 8342.6   0.0152    0.9020
+ particpate:log(preother + 1)   1      0.00 22929 8342.6   0.0001    0.9943
- I(log(preretail + 1)^2)        1     35.79 22965 8354.1  15.4173 8.678e-05
- I(log(prefood + 1)^2)          1     45.02 22974 8358.0  19.3921 1.076e-05
- I(log(prebank + 1)^2)          1     49.11 22978 8359.8  21.1516 4.296e-06
- log(pregas + 1)                1     71.39 23000 8369.4  30.7473 3.015e-08
- log(preother + 1)              1    100.41 23030 8381.9  43.2493 5.063e-11
- log(prefood + 1)               1    155.28 23084 8405.4  66.8810 3.239e-16
- log(prebank + 1)               1    426.08 23355 8520.7 183.5221 < 2.2e-16
                                   
<none>                             
- I(log(pregas + 1)^2)             
- log(preretail + 1):particpate    
+ particpate:log(prefood + 1)      
+ I(log(preother + 1)^2)           
+ particpate:log(prebank + 1)      
+ Rfreq                            
+ log(Rfreq + 1)                   
+ particpate:log(pregas + 1)       
+ particpate:log(preother + 1)     
- I(log(preretail + 1)^2)       ***
- I(log(prefood + 1)^2)         ***
- I(log(prebank + 1)^2)         ***
- log(pregas + 1)               ***
- log(preother + 1)             ***
- log(prefood + 1)              ***
- log(prebank + 1)              ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(im11)

Call:
lm(formula = log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 
    1) + log(pregas + 1) + log(preother + 1) + log(preretail + 
    1) + I(log(prebank + 1)^2) + I(log(prefood + 1)^2) + I(log(preretail + 
    1)^2) + particpate + I(log(pregas + 1)^2) + log(preretail + 
    1):particpate, data = purchaseTraining)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.7326 -1.0656 -0.1621  1.0892  5.8594 

Coefficients:
                               Estimate Std. Error t value Pr(>|t|)    
(Intercept)                    0.569540   0.039056  14.583  < 2e-16 ***
log(prefood + 1)               0.267221   0.032675   8.178 3.24e-16 ***
log(prebank + 1)               0.430610   0.031786  13.547  < 2e-16 ***
log(pregas + 1)                0.284051   0.051226   5.545 3.01e-08 ***
log(preother + 1)              0.128328   0.019513   6.576 5.06e-11 ***
log(preretail + 1)             0.285819   0.062086   4.604 4.20e-06 ***
I(log(prebank + 1)^2)         -0.036230   0.007878  -4.599 4.30e-06 ***
I(log(prefood + 1)^2)          0.032619   0.007407   4.404 1.08e-05 ***
I(log(preretail + 1)^2)       -0.080816   0.020582  -3.926 8.68e-05 ***
particpate                     0.023523   0.033849   0.695    0.487    
I(log(pregas + 1)^2)          -0.027886   0.019322  -1.443    0.149    
log(preretail + 1):particpate  0.082957   0.051228   1.619    0.105    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.524 on 9876 degrees of freedom
Multiple R-squared:  0.2539,	Adjusted R-squared:  0.253 
F-statistic: 305.5 on 11 and 9876 DF,  p-value: < 2.2e-16

> plot(im11)
> 
> im12=step(im1base, scope=~particpate+log(prefood+1)+particpate:log(prefood+1)+
+ log(prebank+1)+particpate:log(prebank+1)+
+ log(pregas+1)+particpate:log(pregas+1)+
+ log(preretail+1)+particpate:log(preretail+1)+
+ log(preother+1)+particpate:log(preother+1)+
+ Rfreq+log(Rfreq+1)+1/Rfreq
+ , test="F", data=purchaseTraining)
Start:  AIC=11214.48
log(mile1 + 1) ~ 1

                     Df Sum of Sq   RSS     AIC   F value  Pr(>F)    
+ log(prefood + 1)    1    4106.6 26624  9798.1 1524.8264 < 2e-16 ***
+ log(prebank + 1)    1    3576.1 27155  9993.2 1301.9245 < 2e-16 ***
+ log(pregas + 1)     1    1305.1 29426 10787.4  438.4678 < 2e-16 ***
+ log(preother + 1)   1     726.9 30004 10979.8  239.5013 < 2e-16 ***
+ log(preretail + 1)  1     505.3 30226 11052.5  165.2823 < 2e-16 ***
+ log(Rfreq + 1)      1      13.6 30717 11212.1    4.3732 0.03653 *  
+ Rfreq               1       9.8 30721 11213.3    3.1657 0.07523 .  
+ particpate          1       9.8 30721 11213.3    3.1415 0.07636 .  
<none>                            30731 11214.5                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=9798.12
log(mile1 + 1) ~ log(prefood + 1)

                     Df Sum of Sq   RSS     AIC   F value  Pr(>F)    
+ log(prebank + 1)    1    3084.1 23540  8582.8 1295.0798 < 2e-16 ***
+ log(pregas + 1)     1     899.3 25725  9460.4  345.5531 < 2e-16 ***
+ log(preother + 1)   1     453.1 26171  9630.4  171.1223 < 2e-16 ***
+ log(preretail + 1)  1     248.8 26376  9707.3   93.2522 < 2e-16 ***
+ particpate          1       7.6 26617  9797.3    2.8401 0.09197 .  
<none>                            26624  9798.1                      
+ log(Rfreq + 1)      1       3.5 26621  9798.8    1.3175 0.25108    
+ Rfreq               1       0.5 26624  9799.9    0.1884 0.66423    
- log(prefood + 1)    1    4106.6 30731 11214.5 1524.8264 < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8582.75
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1)

                     Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(pregas + 1)     1     307.0 23233 8454.9  130.6194 < 2.2e-16 ***
+ log(preother + 1)   1     122.6 23418 8533.1   51.7328 6.820e-13 ***
+ log(preretail + 1)  1      91.2 23449 8546.4   38.4444 5.859e-10 ***
+ particpate          1      10.2 23530 8580.5    4.2949   0.03825 *  
<none>                            23540 8582.8                        
+ Rfreq               1       1.5 23539 8584.1    0.6448   0.42200    
+ log(Rfreq + 1)      1       0.0 23540 8584.7    0.0152   0.90197    
- log(prebank + 1)    1    3084.1 26624 9798.1 1295.0798 < 2.2e-16 ***
- log(prefood + 1)    1    3614.6 27155 9993.2 1517.8254 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8454.94
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1)

                     Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(preother + 1)   1      99.7 23134 8414.4   42.6037 7.032e-11 ***
+ log(preretail + 1)  1      69.0 23164 8427.5   29.4190 5.968e-08 ***
+ particpate          1      10.1 23223 8452.6    4.3164   0.03777 *  
<none>                            23233 8454.9                        
+ Rfreq               1       0.7 23232 8456.6    0.3005   0.58361    
+ log(Rfreq + 1)      1       0.4 23233 8456.8    0.1513   0.69729    
- log(pregas + 1)     1     307.0 23540 8582.8  130.6194 < 2.2e-16 ***
- log(prebank + 1)    1    2491.9 25725 9460.4 1060.1046 < 2.2e-16 ***
- log(prefood + 1)    1    3414.0 26647 9808.6 1452.4165 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8414.4
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1)

                     Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(preretail + 1)  1      58.3 23075 8391.5   24.9629 5.945e-07 ***
+ particpate          1       9.9 23124 8412.2    4.2302   0.03974 *  
<none>                            23134 8414.4                        
+ Rfreq               1       0.7 23133 8416.1    0.2829   0.59481    
+ log(Rfreq + 1)      1       0.3 23133 8416.3    0.1280   0.72053    
- log(preother + 1)   1      99.7 23233 8454.9   42.6037 7.032e-11 ***
- log(pregas + 1)     1     284.2 23418 8533.1  121.4098 < 2.2e-16 ***
- log(prebank + 1)    1    2257.9 25391 9333.3  964.6082 < 2.2e-16 ***
- log(prefood + 1)    1    3311.5 26445 9735.3 1414.7204 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8391.46
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1) + log(preretail + 1)

                     Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ particpate          1       7.8 23067 8390.1    3.3265    0.0682 .  
<none>                            23075 8391.5                        
+ Rfreq               1       0.5 23075 8393.2    0.2199    0.6392    
+ log(Rfreq + 1)      1       0.3 23075 8393.3    0.1404    0.7079    
- log(preretail + 1)  1      58.3 23134 8414.4   24.9629 5.945e-07 ***
- log(preother + 1)   1      89.1 23164 8427.5   38.1403 6.843e-10 ***
- log(pregas + 1)     1     265.7 23341 8502.6  113.7677 < 2.2e-16 ***
- log(prebank + 1)    1    2184.8 25260 9284.0  935.6337 < 2.2e-16 ***
- log(prefood + 1)    1    3209.8 26285 9677.3 1374.5962 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8390.13
log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preother + 1) + log(preretail + 1) + particpate

                                Df Sum of Sq   RSS    AIC   F value    Pr(>F)
<none>                                       23067 8390.1                    
+ particpate:log(preretail + 1)  1       3.5 23064 8390.6    1.4895    0.2223
- particpate                     1       7.8 23075 8391.5    3.3265    0.0682
+ particpate:log(prefood + 1)    1       1.0 23066 8391.7    0.4196    0.5172
+ Rfreq                          1       0.6 23067 8391.9    0.2445    0.6210
+ log(Rfreq + 1)                 1       0.3 23067 8392.0    0.1179    0.7313
+ particpate:log(pregas + 1)     1       0.2 23067 8392.0    0.1069    0.7438
+ particpate:log(prebank + 1)    1       0.2 23067 8392.0    0.1046    0.7463
+ particpate:log(preother + 1)   1       0.2 23067 8392.0    0.1021    0.7493
- log(preretail + 1)             1      56.2 23124 8412.2   24.0552 9.511e-07
- log(preother + 1)              1      89.0 23156 8426.2   38.1361 6.858e-10
- log(pregas + 1)                1     265.9 23333 8501.5  113.9007 < 2.2e-16
- log(prebank + 1)               1    2187.6 25255 9284.0  937.0689 < 2.2e-16
- log(prefood + 1)               1    3209.3 26277 9676.2 1374.7055 < 2.2e-16
                                   
<none>                             
+ particpate:log(preretail + 1)    
- particpate                    .  
+ particpate:log(prefood + 1)      
+ Rfreq                            
+ log(Rfreq + 1)                   
+ particpate:log(pregas + 1)       
+ particpate:log(prebank + 1)      
+ particpate:log(preother + 1)     
- log(preretail + 1)            ***
- log(preother + 1)             ***
- log(pregas + 1)               ***
- log(prebank + 1)              ***
- log(prefood + 1)              ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(im12)

Call:
lm(formula = log(mile1 + 1) ~ log(prefood + 1) + log(prebank + 
    1) + log(pregas + 1) + log(preother + 1) + log(preretail + 
    1) + particpate, data = purchaseTraining)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5229 -1.0794 -0.1826  1.0898  5.9880 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.544864   0.032544  16.742  < 2e-16 ***
log(prefood + 1)   0.403064   0.010871  37.077  < 2e-16 ***
log(prebank + 1)   0.296246   0.009678  30.612  < 2e-16 ***
log(pregas + 1)    0.210573   0.019731  10.672  < 2e-16 ***
log(preother + 1)  0.119798   0.019399   6.175 6.86e-10 ***
log(preretail + 1) 0.126093   0.025709   4.905 9.51e-07 ***
particpate         0.056116   0.030767   1.824   0.0682 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.528 on 9881 degrees of freedom
Multiple R-squared:  0.2494,	Adjusted R-squared:  0.2489 
F-statistic: 547.1 on 6 and 9881 DF,  p-value: < 2.2e-16

> plot(im12)
> 
> yhat=predict(im11, purchaseValidation);
> mean((log(purchaseValidation$mile1+1)-yhat)^2);
[1] 2.288438
> 
> yhat=predict(im12, purchaseValidation);
> mean((log(purchaseValidation$mile1+1)-yhat)^2);
[1] 2.270077
> 
> # im11
> # lm(formula = log(mile1 + 1) ~ log(prefood + 1) + log(prebank +
> #     1) + log(pregas + 1) + log(preother + 1) + log(preretail +
> #     1) + I(log(prebank + 1)^2) + I(log(prefood + 1)^2) + I(log(preretail +
> #     1)^2) + I(log(pregas + 1)^2) + particpate, data = purchaseTraining)
> 
> # im12
> # lm(formula = log(mile1 + 1) ~ log(prefood + 1) + log(prebank +
> #     1) + log(pregas + 1) + log(preother + 1) + log(preretail +
> #     1) + particpate, data = purchaseTraining)
> 
> proc.time()
   user  system elapsed 
  2.864   0.128   3.531 
