
R version 3.4.1 (2017-06-30) -- "Single Candle"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> library(car);
Loading required package: carData
> library(sqldf);
Loading required package: gsubfn
Loading required package: proto
Loading required package: RSQLite
> set.seed(10086);
> 
> purchase=read.csv("party.csv")
> head(purchase,20)
    X particpate elaboration     prefood     pregas   prebank  preretail
1   7          0           0   3.1612892  2.4838696  48.77417  0.5645161
2  12          0           0   0.0000000  0.0000000  46.85483  0.3387096
3  14          0           0   7.5645142  0.9032254  67.51611  0.4516127
4  15          0           0   0.0000000  0.0000000 105.90320  0.0000000
5  18          0           0   0.1129032  0.0000000  26.75806  0.0000000
6  19          1           8   0.0000000 13.5483856  33.53226  0.1129032
7  24          1           8   3.1612892  0.0000000   0.00000  0.0000000
8  35          0           0   1.6935482  0.0000000  24.38708  0.2258064
9  39          0           0  11.7419281  0.0000000 131.87085  0.0000000
10 42          1          23 193.9676514 10.1612854  77.56451  0.3387096
11 44          0           0   4.4032249  9.7096710  76.77417  0.0000000
12 51          0           0  47.4193420  4.5161285  16.25806  3.5000000
13 52          0           0   2.8225803  0.0000000  37.82257  0.1129032
14 67          0           0   0.1129032  0.5645161 141.35474 21.1128998
15 68          1          17   0.5645161  0.3387096  98.67737  1.1290321
16 69          1          26  52.6128845  0.3387096  40.08063  6.6612892
17 75          1          26   5.3064499  0.0000000  49.45160  0.0000000
18 76          0           0  47.8709412  2.2580643  58.03226 21.3386993
19 77          1          40  12.3064499  0.2258064  50.01611  0.7903223
20 91          0           0   0.1129032  0.0000000  93.25806  0.0000000
     preother Rfreq mile1 mile2 mile3 mile4   basemile
1   0.0000000     0     4     3   166     4  54.983845
2  10.9516067     0    93     3    23     0  58.145144
3   0.6774192     0     0     0    84   177  77.112885
4  20.0967712     0     0     0   639     0 125.999969
5   0.1129032     0     0     0     0    59  26.983863
6   8.3548355     0     3     2   110     0  55.548381
7   0.3387096     0     0     1    12     2   3.499999
8   6.2096748     0   260     0    36     0  32.516114
9   0.0000000     0    15     2   426    33 143.612778
10  0.0000000     0   166   266   102    67 282.032161
11 22.9193420     0    37    22   376     9 113.806408
12  0.0000000     0    25    61    54    18  71.693527
13  0.0000000     0    79     1     1    12  40.758054
14 37.5967712     0   252   147    62    64 200.741827
15 22.2419281     0     7     2   174     0 122.951554
16  1.8064508     0   128     0   424    32 101.499962
17  7.1128998     0     1     8     0   116  61.870949
18  0.0000000     0    25   147    40    41 129.499962
19  3.6129017     0   204     5     0    11  66.951594
20  0.0000000     0    13     0    28     0  93.370960
> 
> purchase=sqldf("SELECT * FROM purchase WHERE basemile < 25000");
> attach(purchase)
> 
> 
> purchase$postTotal = mile1 + mile2 + mile3 + mile4;
> purchase$totalRatio = (purchase$postTotal)/(basemile);
> purchase$training = as.integer(runif(nrow(purchase))*5);
> 
> purchaseTraining = sqldf("SELECT * FROM purchase WHERE training < 4");
> purchaseValidation = sqldf("SELECT * FROM purchase WHERE training = 4");
> im1base=lm(log(mile4+1)~1,purchaseTraining)
> 
> im11=step(im1base, scope=~particpate+log(prefood+1)+I(log(prefood+1)^2)+particpate:log(prefood+1)+
+ log(prebank+1)+I(log(prebank+1)^2)+particpate:log(prebank+1)+
+ log(pregas+1)+I(log(pregas+1)^2)+particpate:log(pregas+1)+
+ log(preretail+1)+I(log(preretail+1)^2)+particpate:log(preretail+1)+
+ log(preother+1)+I(log(preother+1)^2)+particpate:log(preother+1)+
+ Rfreq+log(Rfreq+1)+1/Rfreq
+ , test="F", data=purchaseTraining)
Start:  AIC=9858.42
log(mile4 + 1) ~ 1

                          Df Sum of Sq   RSS    AIC   F value  Pr(>F)    
+ log(prefood + 1)         1    3842.7 22950 8329.0 1655.9694 < 2e-16 ***
+ I(log(prefood + 1)^2)    1    3472.8 23320 8487.2 1472.8051 < 2e-16 ***
+ I(log(prebank + 1)^2)    1    2262.2 24530 8987.8  912.0428 < 2e-16 ***
+ log(prebank + 1)         1    2121.9 24671 9044.3  850.6064 < 2e-16 ***
+ log(pregas + 1)          1    1182.8 25610 9413.8  456.7787 < 2e-16 ***
+ I(log(pregas + 1)^2)     1     890.7 25902 9526.0  340.0715 < 2e-16 ***
+ log(preretail + 1)       1     443.3 26350 9695.4  166.3720 < 2e-16 ***
+ log(preother + 1)        1     357.4 26435 9727.6  133.7045 < 2e-16 ***
+ I(log(preother + 1)^2)   1     267.6 26525 9761.1   99.7926 < 2e-16 ***
+ I(log(preretail + 1)^2)  1     204.4 26588 9784.7   76.0265 < 2e-16 ***
+ log(Rfreq + 1)           1      15.5 26777 9854.7    5.7108 0.01688 *  
+ Rfreq                    1      10.8 26782 9856.5    3.9700 0.04635 *  
<none>                                 26793 9858.4                      
+ particpate               1       0.4 26792 9860.3    0.1638 0.68565    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8329.02
log(mile4 + 1) ~ log(prefood + 1)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ I(log(prebank + 1)^2)    1    1837.2 21113 7505.6  860.5292 < 2.2e-16 ***
+ log(prebank + 1)         1    1774.4 21176 7535.0  828.6607 < 2.2e-16 ***
+ log(pregas + 1)          1     786.5 22164 7986.1  350.9087 < 2.2e-16 ***
+ I(log(pregas + 1)^2)     1     602.7 22347 8067.8  266.7232 < 2.2e-16 ***
+ log(preretail + 1)       1     206.0 22744 8241.8   89.5798 < 2.2e-16 ***
+ log(preother + 1)        1     194.7 22755 8246.7   84.6183 < 2.2e-16 ***
+ I(log(preother + 1)^2)   1     158.7 22791 8262.4   68.8440 < 2.2e-16 ***
+ I(log(preretail + 1)^2)  1      96.4 22854 8289.4   41.6963 1.116e-10 ***
+ log(Rfreq + 1)           1       6.2 22944 8328.4    2.6545    0.1033    
<none>                                 22950 8329.0                        
+ Rfreq                    1       2.6 22947 8329.9    1.1073    0.2927    
+ I(log(prefood + 1)^2)    1       1.5 22948 8330.4    0.6612    0.4162    
+ particpate               1       0.9 22949 8330.7    0.3671    0.5446    
- log(prefood + 1)         1    3842.7 26793 9858.4 1655.9694 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=7505.64
log(mile4 + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(pregas + 1)          1     316.2 20796 7358.3  150.3650 < 2.2e-16 ***
+ I(log(pregas + 1)^2)     1     238.0 20875 7395.5  112.7284 < 2.2e-16 ***
+ log(preretail + 1)       1      81.5 21031 7469.4   38.2955 6.322e-10 ***
+ I(log(preretail + 1)^2)  1      38.6 21074 7489.5   18.1096 2.105e-05 ***
+ log(preother + 1)        1      28.2 21085 7494.4   13.2359  0.000276 ***
+ I(log(preother + 1)^2)   1      20.3 21092 7498.1    9.5273  0.002030 ** 
+ log(prebank + 1)         1      14.2 21099 7501.0    6.6481  0.009941 ** 
+ particpate               1       4.6 21108 7505.5    2.1404  0.143500    
<none>                                 21113 7505.6                        
+ log(Rfreq + 1)           1       2.2 21111 7506.6    1.0311  0.309925    
+ I(log(prefood + 1)^2)    1       1.1 21112 7507.1    0.5245  0.468934    
+ Rfreq                    1       0.1 21113 7507.6    0.0683  0.793863    
- I(log(prebank + 1)^2)    1    1837.2 22950 8329.0  860.5292 < 2.2e-16 ***
- log(prefood + 1)         1    3417.8 24530 8987.8 1600.8392 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=7358.35
log(mile4 + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + log(pregas + 
    1)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(preretail + 1)       1      61.4 20735 7331.1   29.2759 6.424e-08 ***
+ I(log(preretail + 1)^2)  1      29.2 20767 7346.4   13.9124 0.0001926 ***
+ log(preother + 1)        1      17.3 20779 7352.1    8.2372 0.0041128 ** 
+ log(prebank + 1)         1      16.6 20780 7352.4    7.9141 0.0049148 ** 
+ I(log(preother + 1)^2)   1      13.2 20783 7354.1    6.2580 0.0123797 *  
+ I(log(pregas + 1)^2)     1       6.3 20790 7357.3    3.0075 0.0829102 .  
+ particpate               1       4.6 20792 7358.2    2.1846 0.1394288    
<none>                                 20796 7358.3                        
+ log(Rfreq + 1)           1       2.5 20794 7359.1    1.2100 0.2713507    
+ I(log(prefood + 1)^2)    1       0.4 20796 7360.1    0.2080 0.6483595    
+ Rfreq                    1       0.2 20796 7360.3    0.0745 0.7848739    
- log(pregas + 1)          1     316.2 21113 7505.6  150.3650 < 2.2e-16 ***
- I(log(prebank + 1)^2)    1    1367.0 22164 7986.1  649.9550 < 2.2e-16 ***
- log(prefood + 1)         1    3211.5 24008 8776.9 1526.9511 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=7331.1
log(mile4 + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + log(pregas + 
    1) + log(preretail + 1)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(prebank + 1)         1     18.17 20717 7324.4    8.6723  0.003238 ** 
+ I(log(preretail + 1)^2)  1     14.46 20721 7326.2    6.8980  0.008642 ** 
+ log(preother + 1)        1     14.13 20721 7326.4    6.7411  0.009436 ** 
+ I(log(preother + 1)^2)   1     11.19 20724 7327.8    5.3385  0.020880 *  
+ I(log(pregas + 1)^2)     1      5.03 20730 7330.7    2.3974  0.121568    
<none>                                 20735 7331.1                        
+ particpate               1      3.04 20732 7331.6    1.4512  0.228368    
+ log(Rfreq + 1)           1      2.31 20733 7332.0    1.1022  0.293815    
+ I(log(prefood + 1)^2)    1      0.41 20735 7332.9    0.1966  0.657513    
+ Rfreq                    1      0.18 20735 7333.0    0.0869  0.768121    
- log(preretail + 1)       1     61.40 20796 7358.3   29.2759 6.424e-08 ***
- log(pregas + 1)          1    296.19 21031 7469.4  141.2323 < 2.2e-16 ***
- I(log(prebank + 1)^2)    1   1291.79 22027 7926.9  615.9551 < 2.2e-16 ***
- log(prefood + 1)         1   3100.23 23835 8707.5 1478.2618 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=7324.43
log(mile4 + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + log(pregas + 
    1) + log(preretail + 1) + log(prebank + 1)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(preother + 1)        1     16.20 20701 7318.7    7.7378  0.005418 ** 
+ I(log(preretail + 1)^2)  1     13.72 20703 7319.9    6.5513  0.010495 *  
+ I(log(preother + 1)^2)   1     13.55 20703 7320.0    6.4672  0.011003 *  
+ I(log(pregas + 1)^2)     1      4.51 20712 7324.3    2.1519  0.142428    
<none>                                 20717 7324.4                        
+ particpate               1      2.89 20714 7325.0    1.3798  0.240162    
+ log(Rfreq + 1)           1      2.31 20715 7325.3    1.1030  0.293626    
+ I(log(prefood + 1)^2)    1      0.46 20716 7326.2    0.2183  0.640357    
+ Rfreq                    1      0.19 20717 7326.3    0.0919  0.761732    
- log(prebank + 1)         1     18.17 20735 7331.1    8.6723  0.003238 ** 
- I(log(prebank + 1)^2)    1     44.34 20761 7343.6   21.1579 4.282e-06 ***
- log(preretail + 1)       1     62.94 20780 7352.4   30.0335 4.351e-08 ***
- log(pregas + 1)          1    298.45 21015 7463.9  142.4207 < 2.2e-16 ***
- log(prefood + 1)         1   3111.53 23828 8706.6 1484.8021 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=7318.69
log(mile4 + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + log(pregas + 
    1) + log(preretail + 1) + log(prebank + 1) + log(preother + 
    1)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ I(log(preretail + 1)^2)  1     13.34 20687 7314.3    6.3728  0.011604 *  
+ I(log(pregas + 1)^2)     1      4.28 20696 7318.6    2.0424  0.153002    
<none>                                 20701 7318.7                        
+ particpate               1      2.82 20698 7319.3    1.3487  0.245529    
+ log(Rfreq + 1)           1      2.15 20699 7319.7    1.0244  0.311495    
+ I(log(prefood + 1)^2)    1      0.58 20700 7320.4    0.2754  0.599764    
+ Rfreq                    1      0.16 20701 7320.6    0.0761  0.782598    
+ I(log(preother + 1)^2)   1      0.03 20701 7320.7    0.0139  0.906223    
- log(preother + 1)        1     16.20 20717 7324.4    7.7378  0.005418 ** 
- log(prebank + 1)         1     20.25 20721 7326.4    9.6689  0.001879 ** 
- I(log(prebank + 1)^2)    1     38.07 20739 7334.9   18.1805 2.028e-05 ***
- log(preretail + 1)       1     59.59 20760 7345.1   28.4558 9.798e-08 ***
- log(pregas + 1)          1    288.96 20990 7453.8  137.9855 < 2.2e-16 ***
- log(prefood + 1)         1   3078.80 23780 8688.3 1470.1847 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=7314.31
log(mile4 + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + log(pregas + 
    1) + log(preretail + 1) + log(prebank + 1) + log(preother + 
    1) + I(log(preretail + 1)^2)

                          Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
<none>                                 20687 7314.3                        
+ I(log(pregas + 1)^2)     1      4.11 20683 7314.3    1.9652  0.160989    
+ particpate               1      2.83 20685 7315.0    1.3512  0.245103    
+ log(Rfreq + 1)           1      2.12 20685 7315.3    1.0119  0.314482    
+ I(log(prefood + 1)^2)    1      0.52 20687 7316.1    0.2480  0.618477    
+ Rfreq                    1      0.16 20687 7316.2    0.0744  0.785069    
+ I(log(preother + 1)^2)   1      0.08 20687 7316.3    0.0365  0.848506    
- I(log(preretail + 1)^2)  1     13.34 20701 7318.7    6.3728  0.011604 *  
- log(preother + 1)        1     15.82 20703 7319.9    7.5591  0.005982 ** 
- log(prebank + 1)         1     19.46 20707 7321.6    9.2954  0.002303 ** 
- I(log(prebank + 1)^2)    1     38.37 20726 7330.6   18.3339 1.871e-05 ***
- log(preretail + 1)       1     44.16 20732 7333.4   21.1001 4.413e-06 ***
- log(pregas + 1)          1    284.25 20972 7447.3  135.8073 < 2.2e-16 ***
- log(prefood + 1)         1   3048.82 23736 8672.2 1456.6623 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(im11)

Call:
lm(formula = log(mile4 + 1) ~ log(prefood + 1) + I(log(prebank + 
    1)^2) + log(pregas + 1) + log(preretail + 1) + log(prebank + 
    1) + log(preother + 1) + I(log(preretail + 1)^2), data = purchaseTraining)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.2792 -0.9905 -0.2641  0.8558  6.6339 

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.47566    0.02871  16.569  < 2e-16 ***
log(prefood + 1)         0.39525    0.01036  38.166  < 2e-16 ***
I(log(prebank + 1)^2)    0.03224    0.00753   4.282 1.87e-05 ***
log(pregas + 1)          0.21889    0.01878  11.654  < 2e-16 ***
log(preretail + 1)       0.26517    0.05773   4.593 4.41e-06 ***
log(prebank + 1)         0.09255    0.03035   3.049  0.00230 ** 
log(preother + 1)        0.05079    0.01847   2.749  0.00598 ** 
I(log(preretail + 1)^2) -0.05487    0.02174  -2.524  0.01160 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.447 on 9884 degrees of freedom
Multiple R-squared:  0.2279,	Adjusted R-squared:  0.2273 
F-statistic: 416.7 on 7 and 9884 DF,  p-value: < 2.2e-16

> plot(im11)
> 
> im12=step(im1base, scope=~particpate+log(prefood+1)+particpate:log(prefood+1)+
+ log(prebank+1)+particpate:log(prebank+1)+
+ log(pregas+1)+particpate:log(pregas+1)+
+ log(preretail+1)+particpate:log(preretail+1)+
+ log(preother+1)+particpate:log(preother+1)+
+ Rfreq+log(Rfreq+1)+1/Rfreq
+ , test="F", data=purchaseTraining)
Start:  AIC=9858.42
log(mile4 + 1) ~ 1

                     Df Sum of Sq   RSS    AIC   F value  Pr(>F)    
+ log(prefood + 1)    1    3842.7 22950 8329.0 1655.9694 < 2e-16 ***
+ log(prebank + 1)    1    2121.9 24671 9044.3  850.6064 < 2e-16 ***
+ log(pregas + 1)     1    1182.8 25610 9413.8  456.7787 < 2e-16 ***
+ log(preretail + 1)  1     443.3 26350 9695.4  166.3720 < 2e-16 ***
+ log(preother + 1)   1     357.4 26435 9727.6  133.7045 < 2e-16 ***
+ log(Rfreq + 1)      1      15.5 26777 9854.7    5.7108 0.01688 *  
+ Rfreq               1      10.8 26782 9856.5    3.9700 0.04635 *  
<none>                            26793 9858.4                      
+ particpate          1       0.4 26792 9860.3    0.1638 0.68565    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=8329.02
log(mile4 + 1) ~ log(prefood + 1)

                     Df Sum of Sq   RSS    AIC   F value Pr(>F)    
+ log(prebank + 1)    1    1774.4 21176 7535.0  828.6607 <2e-16 ***
+ log(pregas + 1)     1     786.5 22164 7986.1  350.9087 <2e-16 ***
+ log(preretail + 1)  1     206.0 22744 8241.8   89.5798 <2e-16 ***
+ log(preother + 1)   1     194.7 22755 8246.7   84.6183 <2e-16 ***
+ log(Rfreq + 1)      1       6.2 22944 8328.4    2.6545 0.1033    
<none>                            22950 8329.0                     
+ Rfreq               1       2.6 22947 8329.9    1.1073 0.2927    
+ particpate          1       0.9 22949 8330.7    0.3671 0.5446    
- log(prefood + 1)    1    3842.7 26793 9858.4 1655.9694 <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=7535.01
log(mile4 + 1) ~ log(prefood + 1) + log(prebank + 1)

                     Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(pregas + 1)     1     345.3 20830 7374.4  163.9175 < 2.2e-16 ***
+ log(preretail + 1)  1      92.8 21083 7493.6   43.5032 4.449e-11 ***
+ log(preother + 1)   1      43.2 21132 7516.8   20.2076 7.027e-06 ***
<none>                            21176 7535.0                        
+ particpate          1       3.8 21172 7535.2    1.7836    0.1817    
+ log(Rfreq + 1)      1       2.4 21173 7535.9    1.1135    0.2914    
+ Rfreq               1       0.2 21175 7536.9    0.1107    0.7394    
- log(prebank + 1)    1    1774.4 22950 8329.0  828.6607 < 2.2e-16 ***
- log(prefood + 1)    1    3495.3 24671 9044.3 1632.3031 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=7374.37
log(mile4 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1)

                     Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(preretail + 1)  1      68.9 20761 7343.6   32.8347 1.033e-08 ***
+ log(preother + 1)   1      27.0 20803 7363.5   12.8525 0.0003387 ***
<none>                            20830 7374.4                        
+ particpate          1       3.9 20826 7374.5    1.8729 0.1711688    
+ log(Rfreq + 1)      1       2.7 20828 7375.1    1.2902 0.2560470    
+ Rfreq               1       0.2 20830 7376.3    0.1111 0.7388591    
- log(pregas + 1)     1     345.3 21176 7535.0  163.9175 < 2.2e-16 ***
- log(prebank + 1)    1    1333.3 22164 7986.1  632.8986 < 2.2e-16 ***
- log(prefood + 1)    1    3267.1 24097 8813.6 1550.8689 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=7343.58
log(mile4 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preretail + 1)

                     Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
+ log(preother + 1)   1     22.47 20739 7334.9   10.7110  0.001069 ** 
<none>                            20761 7343.6                        
+ particpate          1      2.46 20759 7344.4    1.1730  0.278812    
+ log(Rfreq + 1)      1      2.45 20759 7344.4    1.1679  0.279858    
+ Rfreq               1      0.26 20761 7345.5    0.1251  0.723614    
- log(preretail + 1)  1     68.95 20830 7374.4   32.8347 1.033e-08 ***
- log(pregas + 1)     1    321.50 21083 7493.6  153.1075 < 2.2e-16 ***
- log(prebank + 1)    1   1265.62 22027 7926.9  602.7186 < 2.2e-16 ***
- log(prefood + 1)    1   3147.11 23908 8737.7 1498.7226 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=7334.86
log(mile4 + 1) ~ log(prefood + 1) + log(prebank + 1) + log(pregas + 
    1) + log(preretail + 1) + log(preother + 1)

                     Df Sum of Sq   RSS    AIC   F value    Pr(>F)    
<none>                            20739 7334.9                        
+ particpate          1      2.42 20736 7335.7    1.1549  0.282543    
+ log(Rfreq + 1)      1      2.24 20737 7335.8    1.0686  0.301281    
+ Rfreq               1      0.21 20739 7336.8    0.1010  0.750647    
- log(preother + 1)   1     22.47 20761 7343.6   10.7110  0.001069 ** 
- log(preretail + 1)  1     64.37 20803 7363.5   30.6869  3.11e-08 ***
- log(pregas + 1)     1    308.08 21047 7478.7  146.8569 < 2.2e-16 ***
- log(prebank + 1)    1   1187.12 21926 7883.5  565.8888 < 2.2e-16 ***
- log(prefood + 1)    1   3106.18 23845 8713.5 1480.6871 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(im12)

Call:
lm(formula = log(mile4 + 1) ~ log(prefood + 1) + log(prebank + 
    1) + log(pregas + 1) + log(preretail + 1) + log(preother + 
    1), data = purchaseTraining)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.1928 -0.9970 -0.2708  0.8541  6.6634 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.444624   0.027205  16.343  < 2e-16 ***
log(prefood + 1)   0.398159   0.010347  38.480  < 2e-16 ***
log(prebank + 1)   0.217792   0.009155  23.788  < 2e-16 ***
log(pregas + 1)    0.227004   0.018732  12.118  < 2e-16 ***
log(preretail + 1) 0.139051   0.025101   5.540 3.11e-08 ***
log(preother + 1)  0.060148   0.018378   3.273  0.00107 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.448 on 9886 degrees of freedom
Multiple R-squared:  0.226,	Adjusted R-squared:  0.2256 
F-statistic: 577.2 on 5 and 9886 DF,  p-value: < 2.2e-16

> plot(im12)
> 
> yhat=predict(im11, purchaseValidation);
> mean((log(purchaseValidation$mile4+1)-yhat)^2);
[1] 2.097379
> 
> yhat=predict(im12, purchaseValidation);
> mean((log(purchaseValidation$mile4+1)-yhat)^2);
[1] 2.104179
> 
> # im11
> # lm(formula = log(mile1 + 1) ~ log(prefood + 1) + log(prebank +
> #     1) + log(pregas + 1) + log(preother + 1) + log(preretail +
> #     1) + I(log(prebank + 1)^2) + I(log(prefood + 1)^2) + I(log(preretail +
> #     1)^2) + I(log(pregas + 1)^2) + particpate, data = purchaseTraining)
> 
> # im12
> # lm(formula = log(mile1 + 1) ~ log(prefood + 1) + log(prebank +
> #     1) + log(pregas + 1) + log(preother + 1) + log(preretail +
> #     1) + particpate, data = purchaseTraining)
> 
> proc.time()
   user  system elapsed 
  2.548   0.144   6.222 
