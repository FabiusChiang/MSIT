
R version 3.4.1 (2017-06-30) -- "Single Candle"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> library(car);
Loading required package: carData
> 
> purchase=read.csv("party.csv")
> head(purchase,20)
    X particpate elaboration     prefood     pregas   prebank  preretail
1   7          0           0   3.1612892  2.4838696  48.77417  0.5645161
2  12          0           0   0.0000000  0.0000000  46.85483  0.3387096
3  14          0           0   7.5645142  0.9032254  67.51611  0.4516127
4  15          0           0   0.0000000  0.0000000 105.90320  0.0000000
5  18          0           0   0.1129032  0.0000000  26.75806  0.0000000
6  19          1           8   0.0000000 13.5483856  33.53226  0.1129032
7  24          1           8   3.1612892  0.0000000   0.00000  0.0000000
8  35          0           0   1.6935482  0.0000000  24.38708  0.2258064
9  39          0           0  11.7419281  0.0000000 131.87085  0.0000000
10 42          1          23 193.9676514 10.1612854  77.56451  0.3387096
11 44          0           0   4.4032249  9.7096710  76.77417  0.0000000
12 51          0           0  47.4193420  4.5161285  16.25806  3.5000000
13 52          0           0   2.8225803  0.0000000  37.82257  0.1129032
14 67          0           0   0.1129032  0.5645161 141.35474 21.1128998
15 68          1          17   0.5645161  0.3387096  98.67737  1.1290321
16 69          1          26  52.6128845  0.3387096  40.08063  6.6612892
17 75          1          26   5.3064499  0.0000000  49.45160  0.0000000
18 76          0           0  47.8709412  2.2580643  58.03226 21.3386993
19 77          1          40  12.3064499  0.2258064  50.01611  0.7903223
20 91          0           0   0.1129032  0.0000000  93.25806  0.0000000
     preother Rfreq mile1 mile2 mile3 mile4   basemile
1   0.0000000     0     4     3   166     4  54.983845
2  10.9516067     0    93     3    23     0  58.145144
3   0.6774192     0     0     0    84   177  77.112885
4  20.0967712     0     0     0   639     0 125.999969
5   0.1129032     0     0     0     0    59  26.983863
6   8.3548355     0     3     2   110     0  55.548381
7   0.3387096     0     0     1    12     2   3.499999
8   6.2096748     0   260     0    36     0  32.516114
9   0.0000000     0    15     2   426    33 143.612778
10  0.0000000     0   166   266   102    67 282.032161
11 22.9193420     0    37    22   376     9 113.806408
12  0.0000000     0    25    61    54    18  71.693527
13  0.0000000     0    79     1     1    12  40.758054
14 37.5967712     0   252   147    62    64 200.741827
15 22.2419281     0     7     2   174     0 122.951554
16  1.8064508     0   128     0   424    32 101.499962
17  7.1128998     0     1     8     0   116  61.870949
18  0.0000000     0    25   147    40    41 129.499962
19  3.6129017     0   204     5     0    11  66.951594
20  0.0000000     0    13     0    28     0  93.370960
> attach(purchase)
> 
> purchase$postTotal = mile1 + mile2 + mile3 + mile4;
> purchase$diffRatio = (purchase$postTotal - basemile)/basemile;
> 
> # model1=lm(mile1 ~ as.factor(particpate)+elaboration+prefood+Rfreq, purchase);
> # summary(model1);
> # plot(model1);
> 
> # model2=lm(log(diffRatio) ~ as.factor(particpate)+elaboration+Rfreq+log(basemile), purchase);
> # summary(model2);
> # plot(model2);
> # vif(model2)
> 
> # model21=lm(log(diffRatio) ~ as.factor(particpate)+Rfreq+log(basemile), purchase);
> # summary(model21);
> # plot(model21);
> # vif(model21)
> 
> # model3=lm(log(diffRatio) ~ as.factor(particpate)+elaboration+log(basemile), purchase);
> # summary(model3);
> # plot(model3);
> # vif(model3)
> 
> model4=lm(log(diffRatio) ~ particpate+log(basemile), purchase);
Warning message:
In log(diffRatio) : NaNs produced
> summary(model4);

Call:
lm(formula = log(diffRatio) ~ particpate + log(basemile), data = purchase)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.4388  -0.6218   0.1188   0.7510   6.0966 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    1.574954   0.027666   56.93  < 2e-16 ***
particpate     0.103094   0.024549    4.20  2.7e-05 ***
log(basemile) -0.277272   0.007825  -35.43  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.234 on 10112 degrees of freedom
  (2187 observations deleted due to missingness)
Multiple R-squared:  0.1119,	Adjusted R-squared:  0.1118 
F-statistic: 637.3 on 2 and 10112 DF,  p-value: < 2.2e-16

> plot(model4);
> vif(model4)
   particpate log(basemile) 
     1.000022      1.000022 
> 
> model5=lm(log(diffRatio) ~ particpate+log(basemile)+I(log(basemile)^2)+particpate:log(basemile)+particpate:I(log(basemile)^2), purchase);
Warning message:
In log(diffRatio) : NaNs produced
> summary(model5);

Call:
lm(formula = log(diffRatio) ~ particpate + log(basemile) + I(log(basemile)^2) + 
    particpate:log(basemile) + particpate:I(log(basemile)^2), 
    data = purchase)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.2948  -0.6073   0.1293   0.7413   5.1537 

Coefficients:
                               Estimate Std. Error t value Pr(>|t|)    
(Intercept)                    1.605163   0.037319  43.012  < 2e-16 ***
particpate                     0.273215   0.051675   5.287 1.27e-07 ***
log(basemile)                 -0.458101   0.026944 -17.002  < 2e-16 ***
I(log(basemile)^2)             0.046911   0.005499   8.531  < 2e-16 ***
particpate:log(basemile)      -0.112396   0.037021  -3.036   0.0024 ** 
particpate:I(log(basemile)^2)  0.013303   0.007564   1.759   0.0786 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.221 on 10109 degrees of freedom
  (2187 observations deleted due to missingness)
Multiple R-squared:  0.1308,	Adjusted R-squared:  0.1304 
F-statistic: 304.4 on 5 and 10109 DF,  p-value: < 2.2e-16

> plot(model5);
> vif(model5)
                   particpate                 log(basemile) 
                     4.526203                     12.110288 
           I(log(basemile)^2)      particpate:log(basemile) 
                    12.081411                     29.108273 
particpate:I(log(basemile)^2) 
                    21.402212 
> 
> model6=lm(log(diffRatio) ~ particpate+log(basemile)+I(log(basemile)^2)+particpate:I(log(basemile)^2), purchase);
Warning message:
In log(diffRatio) : NaNs produced
> summary(model6);

Call:
lm(formula = log(diffRatio) ~ particpate + log(basemile) + I(log(basemile)^2) + 
    particpate:I(log(basemile)^2), data = purchase)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.2743  -0.6064   0.1292   0.7371   5.2339 

Coefficients:
                               Estimate Std. Error t value Pr(>|t|)    
(Intercept)                    1.658621   0.032917  50.388  < 2e-16 ***
particpate                     0.173041   0.039787   4.349 1.38e-05 ***
log(basemile)                 -0.517639   0.018485 -28.003  < 2e-16 ***
I(log(basemile)^2)             0.057976   0.004119  14.074  < 2e-16 ***
particpate:I(log(basemile)^2) -0.007553   0.003167  -2.385   0.0171 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.222 on 10110 degrees of freedom
  (2187 observations deleted due to missingness)
Multiple R-squared:   0.13,	Adjusted R-squared:  0.1297 
F-statistic: 377.8 on 4 and 10110 DF,  p-value: < 2.2e-16

> plot(model6);
> vif(model6)
                   particpate                 log(basemile) 
                     2.680919                      5.695284 
           I(log(basemile)^2) particpate:I(log(basemile)^2) 
                     6.774400                      3.748990 
> 
> purchase$totalRatio = (purchase$postTotal+1)/(basemile+1);
> 
> model7=lm(log(totalRatio) ~ particpate+log(basemile)+I(log(basemile)^2)+particpate:log(basemile), purchase);
> summary(model7);

Call:
lm(formula = log(totalRatio) ~ particpate + log(basemile) + I(log(basemile)^2) + 
    particpate:log(basemile), data = purchase)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.7789 -0.5345  0.1386  0.6606  5.2503 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)               0.894803   0.027138  32.972  < 2e-16 ***
particpate                0.219837   0.038086   5.772 8.02e-09 ***
log(basemile)             0.040288   0.014765   2.729 0.006371 ** 
I(log(basemile)^2)       -0.018643   0.002862  -6.514 7.62e-11 ***
particpate:log(basemile) -0.042907   0.012131  -3.537 0.000406 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.099 on 12297 degrees of freedom
Multiple R-squared:  0.01457,	Adjusted R-squared:  0.01425 
F-statistic: 45.47 on 4 and 12297 DF,  p-value: < 2.2e-16

> plot(model7);
> vif(model7)
              particpate            log(basemile)       I(log(basemile)^2) 
                3.690511                 5.928526                 5.009896 
particpate:log(basemile) 
                4.694543 
> 
> proc.time()
   user  system elapsed 
  1.432   0.136   2.178 
