
R version 3.4.1 (2017-06-30) -- "Single Candle"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> library(car);
Loading required package: carData
> library(sqldf);
Loading required package: gsubfn
Loading required package: proto
Loading required package: RSQLite
> set.seed(10086);
> 
> purchase=read.csv("party.csv")
> head(purchase,20)
    X particpate elaboration     prefood     pregas   prebank  preretail
1   7          0           0   3.1612892  2.4838696  48.77417  0.5645161
2  12          0           0   0.0000000  0.0000000  46.85483  0.3387096
3  14          0           0   7.5645142  0.9032254  67.51611  0.4516127
4  15          0           0   0.0000000  0.0000000 105.90320  0.0000000
5  18          0           0   0.1129032  0.0000000  26.75806  0.0000000
6  19          1           8   0.0000000 13.5483856  33.53226  0.1129032
7  24          1           8   3.1612892  0.0000000   0.00000  0.0000000
8  35          0           0   1.6935482  0.0000000  24.38708  0.2258064
9  39          0           0  11.7419281  0.0000000 131.87085  0.0000000
10 42          1          23 193.9676514 10.1612854  77.56451  0.3387096
11 44          0           0   4.4032249  9.7096710  76.77417  0.0000000
12 51          0           0  47.4193420  4.5161285  16.25806  3.5000000
13 52          0           0   2.8225803  0.0000000  37.82257  0.1129032
14 67          0           0   0.1129032  0.5645161 141.35474 21.1128998
15 68          1          17   0.5645161  0.3387096  98.67737  1.1290321
16 69          1          26  52.6128845  0.3387096  40.08063  6.6612892
17 75          1          26   5.3064499  0.0000000  49.45160  0.0000000
18 76          0           0  47.8709412  2.2580643  58.03226 21.3386993
19 77          1          40  12.3064499  0.2258064  50.01611  0.7903223
20 91          0           0   0.1129032  0.0000000  93.25806  0.0000000
     preother Rfreq mile1 mile2 mile3 mile4   basemile
1   0.0000000     0     4     3   166     4  54.983845
2  10.9516067     0    93     3    23     0  58.145144
3   0.6774192     0     0     0    84   177  77.112885
4  20.0967712     0     0     0   639     0 125.999969
5   0.1129032     0     0     0     0    59  26.983863
6   8.3548355     0     3     2   110     0  55.548381
7   0.3387096     0     0     1    12     2   3.499999
8   6.2096748     0   260     0    36     0  32.516114
9   0.0000000     0    15     2   426    33 143.612778
10  0.0000000     0   166   266   102    67 282.032161
11 22.9193420     0    37    22   376     9 113.806408
12  0.0000000     0    25    61    54    18  71.693527
13  0.0000000     0    79     1     1    12  40.758054
14 37.5967712     0   252   147    62    64 200.741827
15 22.2419281     0     7     2   174     0 122.951554
16  1.8064508     0   128     0   424    32 101.499962
17  7.1128998     0     1     8     0   116  61.870949
18  0.0000000     0    25   147    40    41 129.499962
19  3.6129017     0   204     5     0    11  66.951594
20  0.0000000     0    13     0    28     0  93.370960
> 
> purchase=sqldf("SELECT * FROM purchase WHERE basemile < 25000 AND basemile > 0");
> attach(purchase)
> 
> 
> purchase$postTotal = mile1 + mile2 + mile3 + mile4;
> purchase$totalRatio = (purchase$postTotal)/(basemile);
> purchase$training = as.integer(runif(nrow(purchase))*5);
> 
> purchaseTraining = sqldf("SELECT * FROM purchase WHERE training < 4");
> purchaseValidation = sqldf("SELECT * FROM purchase WHERE training = 4");
> im1base=lm(log(totalRatio+1)~1,purchaseTraining)
> 
> im11=step(im1base, scope=~particpate+log(prefood+1)+I(log(prefood+1)^2)+particpate:log(prefood+1)+
+ log(prebank+1)+I(log(prebank+1)^2)+particpate:log(prebank+1)+
+ log(pregas+1)+I(log(pregas+1)^2)+particpate:log(pregas+1)+
+ log(preretail+1)+I(log(preretail+1)^2)+particpate:log(preretail+1)+
+ log(preother+1)+I(log(preother+1)^2)+particpate:log(preother+1)+
+ Rfreq+log(Rfreq+1)+1/Rfreq
+ , test="F", data=purchaseTraining)
Start:  AIC=-3567.09
log(totalRatio + 1) ~ 1

                          Df Sum of Sq    RSS     AIC  F value    Pr(>F)    
+ log(prefood + 1)         1   125.878 6770.0 -3747.3 183.8905 < 2.2e-16 ***
+ I(log(prefood + 1)^2)    1   123.566 6772.3 -3744.0 180.4509 < 2.2e-16 ***
+ I(log(prebank + 1)^2)    1    46.730 6849.1 -3632.4  67.4772 2.398e-16 ***
+ I(log(preother + 1)^2)   1    38.338 6857.5 -3620.2  55.2913 1.126e-13 ***
+ log(prebank + 1)         1    32.094 6863.8 -3611.2  46.2436 1.105e-11 ***
+ I(log(preretail + 1)^2)  1    29.847 6866.0 -3608.0  42.9931 5.768e-11 ***
+ log(preother + 1)        1    26.992 6868.9 -3603.9  38.8643 4.729e-10 ***
+ log(preretail + 1)       1    23.007 6872.8 -3598.2  33.1063 8.985e-09 ***
+ I(log(pregas + 1)^2)     1    22.178 6873.7 -3597.0  31.9103 1.659e-08 ***
+ particpate               1    21.825 6874.0 -3596.5  31.4014 2.155e-08 ***
+ log(pregas + 1)          1    18.826 6877.0 -3592.1  27.0747 1.997e-07 ***
<none>                                 6895.9 -3567.1                       
+ Rfreq                    1     0.024 6895.8 -3565.1   0.0342    0.8533    
+ log(Rfreq + 1)           1     0.001 6895.9 -3565.1   0.0018    0.9658    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3747.33
log(totalRatio + 1) ~ log(prefood + 1)

                          Df Sum of Sq    RSS     AIC  F value    Pr(>F)    
+ I(log(prebank + 1)^2)    1    35.760 6734.2 -3797.7  52.5120 4.596e-13 ***
+ I(log(preother + 1)^2)   1    30.433 6739.5 -3789.9  44.6549 2.477e-11 ***
+ log(prebank + 1)         1    24.467 6745.5 -3781.1  35.8690 2.184e-09 ***
+ I(log(preretail + 1)^2)  1    21.716 6748.3 -3777.1  31.8230 1.735e-08 ***
+ particpate               1    21.394 6748.6 -3776.6  31.3494 2.213e-08 ***
+ log(preother + 1)        1    18.535 6751.4 -3772.5  27.1480 1.923e-07 ***
+ I(log(pregas + 1)^2)     1    14.053 6755.9 -3765.9  20.5704 5.815e-06 ***
+ log(preretail + 1)       1    12.887 6757.1 -3764.2  18.8600 1.421e-05 ***
+ log(pregas + 1)          1    10.109 6759.9 -3760.1  14.7891  0.000121 ***
+ I(log(prefood + 1)^2)    1     2.526 6767.4 -3749.0   3.6911  0.054733 .  
<none>                                 6770.0 -3747.3                       
+ log(Rfreq + 1)           1     0.051 6769.9 -3745.4   0.0752  0.783923    
+ Rfreq                    1     0.022 6770.0 -3745.4   0.0324  0.857067    
- log(prefood + 1)         1   125.878 6895.9 -3567.1 183.8905 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3797.72
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2)

                          Df Sum of Sq    RSS     AIC  F value    Pr(>F)    
+ I(log(preother + 1)^2)   1    19.878 6714.3 -3825.0  29.2733 6.432e-08 ***
+ particpate               1    19.872 6714.3 -3825.0  29.2649 6.460e-08 ***
+ I(log(preretail + 1)^2)  1    17.382 6716.8 -3821.3  25.5877 4.303e-07 ***
+ log(preother + 1)        1     9.925 6724.3 -3810.3  14.5943 0.0001341 ***
+ log(preretail + 1)       1     8.175 6726.0 -3807.7  12.0180 0.0005291 ***
+ log(prebank + 1)         1     7.270 6726.9 -3806.4  10.6870 0.0010826 ** 
+ I(log(pregas + 1)^2)     1     6.171 6728.0 -3804.8   9.0689 0.0026066 ** 
+ log(pregas + 1)          1     2.970 6731.2 -3800.1   4.3631 0.0367513 *  
+ I(log(prefood + 1)^2)    1     1.615 6732.6 -3798.1   2.3722 0.1235426    
<none>                                 6734.2 -3797.7                       
+ log(Rfreq + 1)           1     0.134 6734.1 -3795.9   0.1970 0.6571711    
+ Rfreq                    1     0.102 6734.1 -3795.9   0.1499 0.6986072    
- I(log(prebank + 1)^2)    1    35.760 6770.0 -3747.3  52.5120 4.596e-13 ***
- log(prefood + 1)         1   114.908 6849.1 -3632.4 168.7387 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3824.96
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2)

                          Df Sum of Sq    RSS     AIC  F value    Pr(>F)    
+ particpate               1    19.301 6695.0 -3851.4  28.5036 9.560e-08 ***
+ I(log(preretail + 1)^2)  1    16.085 6698.3 -3846.7  23.7426 1.118e-06 ***
+ log(preretail + 1)       1     7.211 6707.1 -3833.6  10.6292  0.001117 ** 
+ log(prebank + 1)         1     5.557 6708.8 -3831.2   8.1898  0.004222 ** 
+ I(log(pregas + 1)^2)     1     5.303 6709.0 -3830.8   7.8154  0.005190 ** 
+ log(preother + 1)        1     3.624 6710.7 -3828.3   5.3399  0.020863 *  
+ log(pregas + 1)          1     2.260 6712.1 -3826.3   3.3286  0.068113 .  
+ I(log(prefood + 1)^2)    1     1.439 6712.9 -3825.1   2.1195  0.145464    
<none>                                 6714.3 -3825.0                       
+ log(Rfreq + 1)           1     0.166 6714.2 -3823.2   0.2446  0.620905    
+ Rfreq                    1     0.123 6714.2 -3823.1   0.1812  0.670364    
- I(log(preother + 1)^2)   1    19.878 6734.2 -3797.7  29.2733 6.432e-08 ***
- I(log(prebank + 1)^2)    1    25.204 6739.5 -3789.9  37.1174 1.154e-09 ***
- log(prefood + 1)         1   110.213 6824.6 -3665.9 162.3066 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3851.44
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2) + particpate

                              Df Sum of Sq    RSS     AIC  F value    Pr(>F)
+ I(log(preretail + 1)^2)      1    17.808 6677.2 -3875.8  26.3660 2.878e-07
+ particpate:log(prefood + 1)  1    12.267 6682.8 -3867.6  18.1463 2.065e-05
+ log(preretail + 1)           1     8.504 6686.5 -3862.0  12.5735 0.0003931
+ log(prebank + 1)             1     5.392 6689.6 -3857.4   7.9684 0.0047697
+ I(log(pregas + 1)^2)         1     5.202 6689.8 -3857.1   7.6878 0.0055698
+ log(preother + 1)            1     2.917 6692.1 -3853.8   4.3094 0.0379290
+ log(pregas + 1)              1     2.265 6692.8 -3852.8   3.3457 0.0674128
+ I(log(prefood + 1)^2)        1     2.043 6693.0 -3852.5   3.0182 0.0823679
<none>                                     6695.0 -3851.4                   
+ log(Rfreq + 1)               1     0.084 6695.0 -3849.6   0.1235 0.7253026
+ Rfreq                        1     0.068 6695.0 -3849.5   0.0998 0.7521194
- particpate                   1    19.301 6714.3 -3825.0  28.5036 9.560e-08
- I(log(preother + 1)^2)       1    19.307 6714.3 -3825.0  28.5120 9.518e-08
- I(log(prebank + 1)^2)        1    24.097 6719.1 -3817.9  35.5853 2.525e-09
- log(prefood + 1)             1   110.098 6805.1 -3692.1 162.5894 < 2.2e-16
                                 
+ I(log(preretail + 1)^2)     ***
+ particpate:log(prefood + 1) ***
+ log(preretail + 1)          ***
+ log(prebank + 1)            ** 
+ I(log(pregas + 1)^2)        ** 
+ log(preother + 1)           *  
+ log(pregas + 1)             .  
+ I(log(prefood + 1)^2)       .  
<none>                           
+ log(Rfreq + 1)                 
+ Rfreq                          
- particpate                  ***
- I(log(preother + 1)^2)      ***
- I(log(prebank + 1)^2)       ***
- log(prefood + 1)            ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3875.79
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2) + particpate + I(log(preretail + 1)^2)

                              Df Sum of Sq    RSS     AIC  F value    Pr(>F)
+ particpate:log(prefood + 1)  1    12.114 6665.1 -3891.8  17.9666 2.269e-05
+ log(prebank + 1)             1     4.831 6672.4 -3880.9   7.1564  0.007482
+ I(log(pregas + 1)^2)         1     4.631 6672.6 -3880.7   6.8609  0.008824
+ log(preretail + 1)           1     4.126 6673.1 -3879.9   6.1114  0.013448
+ log(preother + 1)            1     3.299 6673.9 -3878.7   4.8860  0.027098
+ I(log(prefood + 1)^2)        1     2.065 6675.2 -3876.8   3.0585  0.080349
+ log(pregas + 1)              1     1.744 6675.5 -3876.4   2.5824  0.108088
<none>                                     6677.2 -3875.8                   
+ log(Rfreq + 1)               1     0.098 6677.1 -3873.9   0.1447  0.703699
+ Rfreq                        1     0.056 6677.2 -3873.9   0.0832  0.773046
- I(log(preretail + 1)^2)      1    17.808 6695.0 -3851.4  26.3660 2.878e-07
- I(log(preother + 1)^2)       1    17.939 6695.2 -3851.2  26.5603 2.604e-07
- I(log(prebank + 1)^2)        1    20.858 6698.1 -3846.9  30.8813 2.814e-08
- particpate                   1    21.024 6698.3 -3846.7  31.1278 2.479e-08
- log(prefood + 1)             1   104.007 6781.2 -3724.9 153.9879 < 2.2e-16
                                 
+ particpate:log(prefood + 1) ***
+ log(prebank + 1)            ** 
+ I(log(pregas + 1)^2)        ** 
+ log(preretail + 1)          *  
+ log(preother + 1)           *  
+ I(log(prefood + 1)^2)       .  
+ log(pregas + 1)                
<none>                           
+ log(Rfreq + 1)                 
+ Rfreq                          
- I(log(preretail + 1)^2)     ***
- I(log(preother + 1)^2)      ***
- I(log(prebank + 1)^2)       ***
- particpate                  ***
- log(prefood + 1)            ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3891.75
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2) + particpate + I(log(preretail + 1)^2) + 
    log(prefood + 1):particpate

                              Df Sum of Sq    RSS     AIC F value    Pr(>F)    
+ log(prebank + 1)             1    4.6367 6660.5 -3896.6  6.8807  0.008726 ** 
+ I(log(pregas + 1)^2)         1    4.5872 6660.5 -3896.6  6.8072  0.009093 ** 
+ log(preretail + 1)           1    3.9631 6661.2 -3895.6  5.8805  0.015327 *  
+ log(preother + 1)            1    3.2277 6661.9 -3894.5  4.7889  0.028667 *  
+ log(pregas + 1)              1    1.7517 6663.4 -3892.4  2.5983  0.107007    
+ I(log(prefood + 1)^2)        1    1.6866 6663.4 -3892.3  2.5017  0.113755    
<none>                                     6665.1 -3891.8                      
+ log(Rfreq + 1)               1    0.1133 6665.0 -3889.9  0.1680  0.681912    
+ Rfreq                        1    0.0808 6665.0 -3889.9  0.1199  0.729166    
- log(prefood + 1):particpate  1   12.1143 6677.2 -3875.8 17.9666 2.269e-05 ***
- I(log(preother + 1)^2)       1   17.5692 6682.7 -3867.7 26.0568 3.377e-07 ***
- I(log(preretail + 1)^2)      1   17.6559 6682.8 -3867.6 26.1854 3.160e-07 ***
- I(log(prebank + 1)^2)        1   21.4023 6686.5 -3862.0 31.7417 1.809e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3896.63
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2) + particpate + I(log(preretail + 1)^2) + 
    log(prebank + 1) + log(prefood + 1):particpate

                              Df Sum of Sq    RSS     AIC F value    Pr(>F)    
+ particpate:log(prebank + 1)  1    5.4058 6655.1 -3902.7  8.0278  0.004616 ** 
+ I(log(pregas + 1)^2)         1    4.3833 6656.1 -3901.1  6.5083  0.010752 *  
+ log(preretail + 1)           1    3.8726 6656.6 -3900.4  5.7496  0.016510 *  
+ log(preother + 1)            1    3.1101 6657.4 -3899.3  4.6170  0.031680 *  
+ I(log(prefood + 1)^2)        1    1.7421 6658.7 -3897.2  2.5857  0.107867    
+ log(pregas + 1)              1    1.6818 6658.8 -3897.1  2.4961  0.114157    
<none>                                     6660.5 -3896.6                      
+ log(Rfreq + 1)               1    0.1124 6660.4 -3894.8  0.1667  0.683058    
+ Rfreq                        1    0.0837 6660.4 -3894.8  0.1242  0.724532    
- log(prebank + 1)             1    4.6367 6665.1 -3891.8  6.8807  0.008726 ** 
- I(log(prebank + 1)^2)        1   11.6385 6672.1 -3881.4 17.2712 3.268e-05 ***
- log(prefood + 1):particpate  1   11.9204 6672.4 -3880.9 17.6895 2.623e-05 ***
- I(log(preother + 1)^2)       1   16.1215 6676.6 -3874.7 23.9240 1.018e-06 ***
- I(log(preretail + 1)^2)      1   17.1091 6677.6 -3873.3 25.3895 4.768e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3902.67
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2) + particpate + I(log(preretail + 1)^2) + 
    log(prebank + 1) + log(prefood + 1):particpate + particpate:log(prebank + 
    1)

                              Df Sum of Sq    RSS     AIC F value    Pr(>F)    
+ I(log(pregas + 1)^2)         1    4.5006 6650.6 -3907.4  6.6874  0.009724 ** 
+ log(preretail + 1)           1    4.0117 6651.1 -3906.6  5.9605  0.014648 *  
+ log(preother + 1)            1    3.1442 6651.9 -3905.3  4.6710  0.030701 *  
+ log(pregas + 1)              1    1.7153 6653.4 -3903.2  2.5477  0.110486    
+ I(log(prefood + 1)^2)        1    1.6710 6653.4 -3903.2  2.4818  0.115200    
<none>                                     6655.1 -3902.7                      
+ log(Rfreq + 1)               1    0.0984 6655.0 -3900.8  0.1460  0.702349    
+ Rfreq                        1    0.0790 6655.0 -3900.8  0.1173  0.732010    
- particpate:log(prebank + 1)  1    5.4058 6660.5 -3896.6  8.0278  0.004616 ** 
- log(prefood + 1):particpate  1   10.8329 6665.9 -3888.6 16.0873 6.093e-05 ***
- I(log(prebank + 1)^2)        1   11.9802 6667.1 -3886.9 17.7910 2.488e-05 ***
- I(log(preother + 1)^2)       1   16.6004 6671.7 -3880.0 24.6521 6.982e-07 ***
- I(log(preretail + 1)^2)      1   17.2940 6672.4 -3879.0 25.6822 4.098e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3907.36
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2) + particpate + I(log(preretail + 1)^2) + 
    log(prebank + 1) + I(log(pregas + 1)^2) + log(prefood + 1):particpate + 
    particpate:log(prebank + 1)

                              Df Sum of Sq    RSS     AIC F value    Pr(>F)    
+ log(preretail + 1)           1    4.4301 6646.1 -3911.9  6.5864  0.010291 *  
+ log(preother + 1)            1    3.4627 6647.1 -3910.5  5.1474  0.023303 *  
+ log(pregas + 1)              1    2.7906 6647.8 -3909.5  4.1478  0.041716 *  
+ I(log(prefood + 1)^2)        1    1.8159 6648.8 -3908.1  2.6988  0.100459    
<none>                                     6650.6 -3907.4                      
+ log(Rfreq + 1)               1    0.0807 6650.5 -3905.5  0.1200  0.729077    
+ Rfreq                        1    0.0739 6650.5 -3905.5  0.1098  0.740400    
- I(log(pregas + 1)^2)         1    4.5006 6655.1 -3902.7  6.6874  0.009724 ** 
- particpate:log(prebank + 1)  1    5.5231 6656.1 -3901.1  8.2067  0.004182 ** 
- I(log(prebank + 1)^2)        1   10.7106 6661.3 -3893.4 15.9147 6.674e-05 ***
- log(prefood + 1):particpate  1   10.7848 6661.4 -3893.3 16.0249 6.297e-05 ***
- I(log(preother + 1)^2)       1   15.9323 6666.5 -3885.7 23.6737 1.159e-06 ***
- I(log(preretail + 1)^2)      1   16.7540 6667.3 -3884.5 24.8946 6.158e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3911.95
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2) + particpate + I(log(preretail + 1)^2) + 
    log(prebank + 1) + I(log(pregas + 1)^2) + log(preretail + 
    1) + log(prefood + 1):particpate + particpate:log(prebank + 
    1)

                                Df Sum of Sq    RSS     AIC F value    Pr(>F)
+ log(preother + 1)              1    3.1071 6643.0 -3914.6  4.6210  0.031606
+ log(pregas + 1)                1    2.4785 6643.7 -3913.6  3.6859  0.054903
+ I(log(prefood + 1)^2)          1    1.7505 6644.4 -3912.6  2.6029  0.106702
<none>                                       6646.1 -3911.9                  
+ Rfreq                          1    0.0747 6646.1 -3910.1  0.1110  0.739025
+ log(Rfreq + 1)                 1    0.0733 6646.1 -3910.1  0.1090  0.741294
+ particpate:log(preretail + 1)  1    0.0275 6646.1 -3910.0  0.0409  0.839653
- log(preretail + 1)             1    4.4301 6650.6 -3907.4  6.5864  0.010291
- I(log(pregas + 1)^2)           1    4.9191 6651.1 -3906.6  7.3133  0.006856
- particpate:log(prebank + 1)    1    5.6765 6651.8 -3905.5  8.4395  0.003680
- log(prefood + 1):particpate    1   10.6088 6656.7 -3898.2 15.7724 7.194e-05
- I(log(prebank + 1)^2)          1   10.9660 6657.1 -3897.6 16.3034 5.438e-05
- I(log(preretail + 1)^2)        1   13.5115 6659.7 -3893.9 20.0880 7.479e-06
- I(log(preother + 1)^2)         1   16.1960 6662.3 -3889.9 24.0790 9.394e-07
                                   
+ log(preother + 1)             *  
+ log(pregas + 1)               .  
+ I(log(prefood + 1)^2)            
<none>                             
+ Rfreq                            
+ log(Rfreq + 1)                   
+ particpate:log(preretail + 1)    
- log(preretail + 1)            *  
- I(log(pregas + 1)^2)          ** 
- particpate:log(prebank + 1)   ** 
- log(prefood + 1):particpate   ***
- I(log(prebank + 1)^2)         ***
- I(log(preretail + 1)^2)       ***
- I(log(preother + 1)^2)        ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3914.58
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2) + particpate + I(log(preretail + 1)^2) + 
    log(prebank + 1) + I(log(pregas + 1)^2) + log(preretail + 
    1) + log(preother + 1) + log(prefood + 1):particpate + particpate:log(prebank + 
    1)

                                Df Sum of Sq    RSS     AIC F value    Pr(>F)
+ log(pregas + 1)                1    2.3732 6640.7 -3916.1  3.5305  0.060278
+ I(log(prefood + 1)^2)          1    1.7904 6641.2 -3915.2  2.6633  0.102721
<none>                                       6643.0 -3914.6                  
+ Rfreq                          1    0.0678 6643.0 -3912.7  0.1008  0.750853
+ log(Rfreq + 1)                 1    0.0627 6643.0 -3912.7  0.0932  0.760136
+ particpate:log(preother + 1)   1    0.0278 6643.0 -3912.6  0.0414  0.838797
+ particpate:log(preretail + 1)  1    0.0215 6643.0 -3912.6  0.0320  0.857931
- log(preother + 1)              1    3.1071 6646.1 -3911.9  4.6210  0.031606
- log(preretail + 1)             1    4.0744 6647.1 -3910.5  6.0598  0.013846
- I(log(pregas + 1)^2)           1    5.2162 6648.2 -3908.8  7.7578  0.005358
- particpate:log(prebank + 1)    1    5.7092 6648.7 -3908.1  8.4911  0.003577
- log(prefood + 1):particpate    1   10.5480 6653.6 -3900.9 15.6878 7.523e-05
- I(log(prebank + 1)^2)          1   11.0018 6654.0 -3900.2 16.3627 5.270e-05
- I(log(preother + 1)^2)         1   11.3438 6654.4 -3899.7 16.8713 4.032e-05
- I(log(preretail + 1)^2)        1   13.0856 6656.1 -3897.1 19.4619 1.037e-05
                                   
+ log(pregas + 1)               .  
+ I(log(prefood + 1)^2)            
<none>                             
+ Rfreq                            
+ log(Rfreq + 1)                   
+ particpate:log(preother + 1)     
+ particpate:log(preretail + 1)    
- log(preother + 1)             *  
- log(preretail + 1)            *  
- I(log(pregas + 1)^2)          ** 
- particpate:log(prebank + 1)   ** 
- log(prefood + 1):particpate   ***
- I(log(prebank + 1)^2)         ***
- I(log(preother + 1)^2)        ***
- I(log(preretail + 1)^2)       ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3916.11
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2) + particpate + I(log(preretail + 1)^2) + 
    log(prebank + 1) + I(log(pregas + 1)^2) + log(preretail + 
    1) + log(preother + 1) + log(pregas + 1) + log(prefood + 
    1):particpate + particpate:log(prebank + 1)

                                Df Sum of Sq    RSS     AIC F value    Pr(>F)
+ I(log(prefood + 1)^2)          1    1.7997 6638.9 -3916.8  2.6778  0.101791
<none>                                       6640.7 -3916.1                  
+ particpate:log(pregas + 1)     1    1.0712 6639.6 -3915.7  1.5937  0.206827
- log(pregas + 1)                1    2.3732 6643.0 -3914.6  3.5305  0.060278
+ Rfreq                          1    0.0617 6640.6 -3914.2  0.0918  0.761952
+ log(Rfreq + 1)                 1    0.0521 6640.6 -3914.2  0.0774  0.780792
+ particpate:log(preother + 1)   1    0.0238 6640.6 -3914.1  0.0354  0.850828
+ particpate:log(preretail + 1)  1    0.0230 6640.6 -3914.1  0.0342  0.853354
- log(preother + 1)              1    3.0017 6643.7 -3913.6  4.4655  0.034610
- log(preretail + 1)             1    3.7880 6644.4 -3912.5  5.6353  0.017622
- I(log(pregas + 1)^2)           1    5.3144 6646.0 -3910.2  7.9060  0.004937
- particpate:log(prebank + 1)    1    5.8066 6646.5 -3909.5  8.6382  0.003299
- log(prefood + 1):particpate    1   10.4557 6651.1 -3902.5 15.5544 8.072e-05
- I(log(prebank + 1)^2)          1   11.1457 6651.8 -3901.5 16.5810 4.698e-05
- I(log(preother + 1)^2)         1   11.3065 6652.0 -3901.3 16.8202 4.142e-05
- I(log(preretail + 1)^2)        1   12.8200 6653.5 -3899.0 19.0717 1.272e-05
                                   
+ I(log(prefood + 1)^2)            
<none>                             
+ particpate:log(pregas + 1)       
- log(pregas + 1)               .  
+ Rfreq                            
+ log(Rfreq + 1)                   
+ particpate:log(preother + 1)     
+ particpate:log(preretail + 1)    
- log(preother + 1)             *  
- log(preretail + 1)            *  
- I(log(pregas + 1)^2)          ** 
- particpate:log(prebank + 1)   ** 
- log(prefood + 1):particpate   ***
- I(log(prebank + 1)^2)         ***
- I(log(preother + 1)^2)        ***
- I(log(preretail + 1)^2)       ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3916.79
log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 1)^2) + 
    I(log(preother + 1)^2) + particpate + I(log(preretail + 1)^2) + 
    log(prebank + 1) + I(log(pregas + 1)^2) + log(preretail + 
    1) + log(preother + 1) + log(pregas + 1) + I(log(prefood + 
    1)^2) + log(prefood + 1):particpate + particpate:log(prebank + 
    1)

                                Df Sum of Sq    RSS     AIC F value    Pr(>F)
<none>                                       6638.9 -3916.8                  
+ particpate:log(pregas + 1)     1    1.0575 6637.8 -3916.4  1.5736 0.2097113
- I(log(prefood + 1)^2)          1    1.7997 6640.7 -3916.1  2.6778 0.1017909
- log(pregas + 1)                1    2.3825 6641.2 -3915.2  3.5449 0.0597574
+ Rfreq                          1    0.0673 6638.8 -3914.9  0.1001 0.7517515
+ log(Rfreq + 1)                 1    0.0574 6638.8 -3914.9  0.0854 0.7700755
+ particpate:log(preretail + 1)  1    0.0261 6638.8 -3914.8  0.0388 0.8438733
+ particpate:log(preother + 1)   1    0.0214 6638.8 -3914.8  0.0319 0.8582369
- log(preother + 1)              1    3.0409 6641.9 -3914.3  4.5246 0.0334359
- log(preretail + 1)             1    3.7242 6642.6 -3913.2  5.5412 0.0185933
- I(log(pregas + 1)^2)           1    5.3876 6644.2 -3910.8  8.0163 0.0046452
- particpate:log(prebank + 1)    1    5.7313 6644.6 -3910.3  8.5277 0.0035057
- log(prefood + 1):particpate    1   10.1010 6649.0 -3903.8 15.0294 0.0001065
- I(log(prebank + 1)^2)          1   11.0713 6649.9 -3902.3 16.4731 4.973e-05
- I(log(preother + 1)^2)         1   11.3008 6650.2 -3902.0 16.8145 4.155e-05
- I(log(preretail + 1)^2)        1   12.7181 6651.6 -3899.9 18.9234 1.374e-05
                                   
<none>                             
+ particpate:log(pregas + 1)       
- I(log(prefood + 1)^2)            
- log(pregas + 1)               .  
+ Rfreq                            
+ log(Rfreq + 1)                   
+ particpate:log(preretail + 1)    
+ particpate:log(preother + 1)     
- log(preother + 1)             *  
- log(preretail + 1)            *  
- I(log(pregas + 1)^2)          ** 
- particpate:log(prebank + 1)   ** 
- log(prefood + 1):particpate   ***
- I(log(prebank + 1)^2)         ***
- I(log(preother + 1)^2)        ***
- I(log(preretail + 1)^2)       ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(im11)

Call:
lm(formula = log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank + 
    1)^2) + I(log(preother + 1)^2) + particpate + I(log(preretail + 
    1)^2) + log(prebank + 1) + I(log(pregas + 1)^2) + log(preretail + 
    1) + log(preother + 1) + log(pregas + 1) + I(log(prefood + 
    1)^2) + log(prefood + 1):particpate + particpate:log(prebank + 
    1), data = purchaseTraining)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6908 -0.4938 -0.0095  0.4187  6.7362 

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  1.437564   0.024194  59.417  < 2e-16 ***
log(prefood + 1)            -0.022709   0.018441  -1.231 0.218183    
I(log(prebank + 1)^2)       -0.017354   0.004276  -4.059 4.97e-05 ***
I(log(preother + 1)^2)      -0.031698   0.007730  -4.101 4.15e-05 ***
particpate                   0.213528   0.029599   7.214 5.83e-13 ***
I(log(preretail + 1)^2)     -0.053623   0.012327  -4.350 1.37e-05 ***
log(prebank + 1)             0.058076   0.018013   3.224 0.001268 ** 
I(log(pregas + 1)^2)        -0.029458   0.010404  -2.831 0.004645 ** 
log(preretail + 1)           0.077113   0.032759   2.354 0.018593 *  
log(preother + 1)            0.050083   0.023545   2.127 0.033436 *  
log(pregas + 1)              0.051716   0.027467   1.883 0.059757 .  
I(log(prefood + 1)^2)       -0.006567   0.004013  -1.636 0.101791    
log(prefood + 1):particpate -0.045054   0.011622  -3.877 0.000107 ***
particpate:log(prebank + 1) -0.028987   0.009926  -2.920 0.003506 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.8198 on 9878 degrees of freedom
Multiple R-squared:  0.03727,	Adjusted R-squared:  0.036 
F-statistic: 29.41 on 13 and 9878 DF,  p-value: < 2.2e-16

> plot(im11)
> 
> im12=step(im1base, scope=~particpate+log(prefood+1)+particpate:log(prefood+1)+
+ log(prebank+1)+particpate:log(prebank+1)+
+ log(pregas+1)+particpate:log(pregas+1)+
+ log(preretail+1)+particpate:log(preretail+1)+
+ log(preother+1)+particpate:log(preother+1)+
+ Rfreq+log(Rfreq+1)+1/Rfreq
+ , test="F", data=purchaseTraining)
Start:  AIC=-3567.09
log(totalRatio + 1) ~ 1

                     Df Sum of Sq    RSS     AIC  F value    Pr(>F)    
+ log(prefood + 1)    1   125.878 6770.0 -3747.3 183.8905 < 2.2e-16 ***
+ log(prebank + 1)    1    32.094 6863.8 -3611.2  46.2436 1.105e-11 ***
+ log(preother + 1)   1    26.992 6868.9 -3603.9  38.8643 4.729e-10 ***
+ log(preretail + 1)  1    23.007 6872.8 -3598.2  33.1063 8.985e-09 ***
+ particpate          1    21.825 6874.0 -3596.5  31.4014 2.155e-08 ***
+ log(pregas + 1)     1    18.826 6877.0 -3592.1  27.0747 1.997e-07 ***
<none>                            6895.9 -3567.1                       
+ Rfreq               1     0.024 6895.8 -3565.1   0.0342    0.8533    
+ log(Rfreq + 1)      1     0.001 6895.9 -3565.1   0.0018    0.9658    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3747.33
log(totalRatio + 1) ~ log(prefood + 1)

                     Df Sum of Sq    RSS     AIC  F value    Pr(>F)    
+ log(prebank + 1)    1    24.467 6745.5 -3781.1  35.8690 2.184e-09 ***
+ particpate          1    21.394 6748.6 -3776.6  31.3494 2.213e-08 ***
+ log(preother + 1)   1    18.535 6751.4 -3772.5  27.1480 1.923e-07 ***
+ log(preretail + 1)  1    12.887 6757.1 -3764.2  18.8600 1.421e-05 ***
+ log(pregas + 1)     1    10.109 6759.9 -3760.1  14.7891  0.000121 ***
<none>                            6770.0 -3747.3                       
+ log(Rfreq + 1)      1     0.051 6769.9 -3745.4   0.0752  0.783923    
+ Rfreq               1     0.022 6770.0 -3745.4   0.0324  0.857067    
- log(prefood + 1)    1   125.878 6895.9 -3567.1 183.8905 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3781.15
log(totalRatio + 1) ~ log(prefood + 1) + log(prebank + 1)

                     Df Sum of Sq    RSS     AIC  F value    Pr(>F)    
+ particpate          1    20.301 6725.2 -3809.0  29.8484 4.785e-08 ***
+ log(preother + 1)   1    12.121 6733.4 -3796.9  17.7991 2.477e-05 ***
+ log(preretail + 1)  1     9.288 6736.2 -3792.8  13.6342 0.0002233 ***
+ log(pregas + 1)     1     4.265 6741.2 -3785.4   6.2559 0.0123942 *  
<none>                            6745.5 -3781.1                       
+ log(Rfreq + 1)      1     0.114 6745.4 -3779.3   0.1666 0.6831694    
+ Rfreq               1     0.079 6745.4 -3779.3   0.1151 0.7344195    
- log(prebank + 1)    1    24.467 6770.0 -3747.3  35.8690 2.184e-09 ***
- log(prefood + 1)    1   118.252 6863.8 -3611.2 173.3583 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3808.96
log(totalRatio + 1) ~ log(prefood + 1) + log(prebank + 1) + particpate

                              Df Sum of Sq    RSS     AIC  F value    Pr(>F)
+ particpate:log(prefood + 1)  1    12.671 6712.5 -3825.6  18.6640 1.574e-05
+ log(preother + 1)            1    12.291 6712.9 -3825.1  18.1029 2.112e-05
+ log(preretail + 1)           1    10.745 6714.5 -3822.8  15.8215 7.010e-05
+ particpate:log(prebank + 1)  1     5.260 6719.9 -3814.7   7.7396  0.005412
+ log(pregas + 1)              1     4.233 6721.0 -3813.2   6.2270  0.012598
<none>                                     6725.2 -3809.0                   
+ log(Rfreq + 1)               1     0.047 6725.2 -3807.0   0.0691  0.792647
+ Rfreq                        1     0.035 6725.2 -3807.0   0.0521  0.819480
- particpate                   1    20.301 6745.5 -3781.1  29.8484 4.785e-08
- log(prebank + 1)             1    23.374 6748.6 -3776.6  34.3669 4.710e-09
- log(prefood + 1)             1   118.002 6843.2 -3638.9 173.4967 < 2.2e-16
                                 
+ particpate:log(prefood + 1) ***
+ log(preother + 1)           ***
+ log(preretail + 1)          ***
+ particpate:log(prebank + 1) ** 
+ log(pregas + 1)             *  
<none>                           
+ log(Rfreq + 1)                 
+ Rfreq                          
- particpate                  ***
- log(prebank + 1)            ***
- log(prefood + 1)            ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3825.62
log(totalRatio + 1) ~ log(prefood + 1) + log(prebank + 1) + particpate + 
    log(prefood + 1):particpate

                              Df Sum of Sq    RSS     AIC F value    Pr(>F)    
+ log(preother + 1)            1   12.0654 6700.5 -3841.4 17.8016 2.474e-05 ***
+ log(preretail + 1)           1   10.7374 6701.8 -3839.5 15.8390 6.946e-05 ***
+ particpate:log(prebank + 1)  1    4.2639 6708.3 -3829.9  6.2837   0.01220 *  
+ log(pregas + 1)              1    4.2240 6708.3 -3829.8  6.2249   0.01261 *  
<none>                                     6712.5 -3825.6                      
+ log(Rfreq + 1)               1    0.0586 6712.5 -3823.7  0.0863   0.76892    
+ Rfreq                        1    0.0562 6712.5 -3823.7  0.0827   0.77361    
- log(prefood + 1):particpate  1   12.6715 6725.2 -3809.0 18.6640 1.574e-05 ***
- log(prebank + 1)             1   23.9939 6736.5 -3792.3 35.3410 2.861e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3841.42
log(totalRatio + 1) ~ log(prefood + 1) + log(prebank + 1) + particpate + 
    log(preother + 1) + log(prefood + 1):particpate

                               Df Sum of Sq    RSS     AIC F value    Pr(>F)
+ log(preretail + 1)            1    9.4241 6691.0 -3853.3 13.9227 0.0001915
+ particpate:log(prebank + 1)   1    4.6308 6695.8 -3846.3  6.8364 0.0089457
+ log(pregas + 1)               1    3.2442 6697.2 -3844.2  4.7884 0.0286756
<none>                                      6700.5 -3841.4                  
+ particpate:log(preother + 1)  1    0.0955 6700.4 -3839.6  0.1409 0.7074047
+ log(Rfreq + 1)                1    0.0854 6700.4 -3839.5  0.1259 0.7226840
+ Rfreq                         1    0.0749 6700.4 -3839.5  0.1105 0.7395667
- log(preother + 1)             1   12.0654 6712.5 -3825.6 17.8016 2.474e-05
- log(prefood + 1):particpate   1   12.4457 6712.9 -3825.1 18.3626 1.843e-05
- log(prebank + 1)              1   17.6574 6718.1 -3817.4 26.0520 3.385e-07
                                  
+ log(preretail + 1)           ***
+ particpate:log(prebank + 1)  ** 
+ log(pregas + 1)              *  
<none>                            
+ particpate:log(preother + 1)    
+ log(Rfreq + 1)                  
+ Rfreq                           
- log(preother + 1)            ***
- log(prefood + 1):particpate  ***
- log(prebank + 1)             ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3853.34
log(totalRatio + 1) ~ log(prefood + 1) + log(prebank + 1) + particpate + 
    log(preother + 1) + log(preretail + 1) + log(prefood + 1):particpate

                                Df Sum of Sq    RSS     AIC F value    Pr(>F)
+ particpate:log(prebank + 1)    1    4.6741 6686.4 -3858.3  6.9094 0.0085875
+ log(pregas + 1)                1    2.5424 6688.5 -3855.1  3.7570 0.0526141
<none>                                       6691.0 -3853.3                  
+ particpate:log(preretail + 1)  1    0.1500 6690.9 -3851.6  0.2216 0.6378371
+ log(Rfreq + 1)                 1    0.0990 6690.9 -3851.5  0.1463 0.7021455
+ particpate:log(preother + 1)   1    0.0972 6690.9 -3851.5  0.1435 0.7048103
+ Rfreq                          1    0.0666 6691.0 -3851.4  0.0983 0.7538518
- log(preretail + 1)             1    9.4241 6700.5 -3841.4 13.9227 0.0001915
- log(preother + 1)              1   10.7522 6701.8 -3839.5 15.8847 6.780e-05
- log(prefood + 1):particpate    1   12.4510 6703.5 -3836.9 18.3944 1.813e-05
- log(prebank + 1)               1   14.9385 6706.0 -3833.3 22.0694 2.665e-06
                                   
+ particpate:log(prebank + 1)   ** 
+ log(pregas + 1)               .  
<none>                             
+ particpate:log(preretail + 1)    
+ log(Rfreq + 1)                   
+ particpate:log(preother + 1)     
+ Rfreq                            
- log(preretail + 1)            ***
- log(preother + 1)             ***
- log(prefood + 1):particpate   ***
- log(prebank + 1)              ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3858.25
log(totalRatio + 1) ~ log(prefood + 1) + log(prebank + 1) + particpate + 
    log(preother + 1) + log(preretail + 1) + log(prefood + 1):particpate + 
    log(prebank + 1):particpate

                                Df Sum of Sq    RSS     AIC F value    Pr(>F)
+ log(pregas + 1)                1    2.5946 6683.8 -3860.1  3.8366 0.0501739
<none>                                       6686.4 -3858.3                  
+ particpate:log(preother + 1)   1    0.4956 6685.9 -3857.0  0.7326 0.3920583
+ log(Rfreq + 1)                 1    0.0867 6686.3 -3856.4  0.1281 0.7204407
+ Rfreq                          1    0.0625 6686.3 -3856.3  0.0923 0.7612314
+ particpate:log(preretail + 1)  1    0.0185 6686.4 -3856.3  0.0273 0.8686855
- log(prebank + 1):particpate    1    4.6741 6691.0 -3853.3  6.9094 0.0085875
- log(preretail + 1)             1    9.4675 6695.8 -3846.3 13.9951 0.0001843
- log(preother + 1)              1   11.0973 6697.5 -3843.8 16.4044 5.156e-05
- log(prefood + 1):particpate    1   11.4168 6697.8 -3843.4 16.8767 4.021e-05
                                   
+ log(pregas + 1)               .  
<none>                             
+ particpate:log(preother + 1)     
+ log(Rfreq + 1)                   
+ Rfreq                            
+ particpate:log(preretail + 1)    
- log(prebank + 1):particpate   ** 
- log(preretail + 1)            ***
- log(preother + 1)             ***
- log(prefood + 1):particpate   ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step:  AIC=-3860.09
log(totalRatio + 1) ~ log(prefood + 1) + log(prebank + 1) + particpate + 
    log(preother + 1) + log(preretail + 1) + log(pregas + 1) + 
    log(prefood + 1):particpate + log(prebank + 1):particpate

                                Df Sum of Sq    RSS     AIC F value    Pr(>F)
<none>                                       6683.8 -3860.1                  
+ particpate:log(pregas + 1)     1    1.1581 6682.6 -3859.8  1.7125 0.1906937
+ particpate:log(preother + 1)   1    0.4587 6683.3 -3858.8  0.6782 0.4102301
- log(pregas + 1)                1    2.5946 6686.4 -3858.3  3.8366 0.0501739
+ log(Rfreq + 1)                 1    0.0799 6683.7 -3858.2  0.1181 0.7310713
+ Rfreq                          1    0.0622 6683.7 -3858.2  0.0920 0.7616191
+ particpate:log(preretail + 1)  1    0.0271 6683.7 -3858.1  0.0401 0.8413246
- log(prebank + 1):particpate    1    4.7264 6688.5 -3855.1  6.9887 0.0082157
- log(preretail + 1)             1    8.7576 6692.5 -3849.1 12.9494 0.0003216
- log(preother + 1)              1   10.3033 6694.1 -3846.9 15.2351 9.555e-05
- log(prefood + 1):particpate    1   11.4120 6695.2 -3845.2 16.8744 4.026e-05
                                   
<none>                             
+ particpate:log(pregas + 1)       
+ particpate:log(preother + 1)     
- log(pregas + 1)               .  
+ log(Rfreq + 1)                   
+ Rfreq                            
+ particpate:log(preretail + 1)    
- log(prebank + 1):particpate   ** 
- log(preretail + 1)            ***
- log(preother + 1)             ***
- log(prefood + 1):particpate   ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> summary(im12)

Call:
lm(formula = log(totalRatio + 1) ~ log(prefood + 1) + log(prebank + 
    1) + particpate + log(preother + 1) + log(preretail + 1) + 
    log(pregas + 1) + log(prefood + 1):particpate + log(prebank + 
    1):particpate, data = purchaseTraining)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.7139 -0.4855 -0.0051  0.4195  6.6740 

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  1.498482   0.021630  69.277  < 2e-16 ***
log(prefood + 1)            -0.046961   0.008496  -5.528 3.33e-08 ***
log(prebank + 1)            -0.008689   0.007164  -1.213 0.225197    
particpate                   0.217614   0.029682   7.332 2.45e-13 ***
log(preother + 1)           -0.040743   0.010438  -3.903 9.56e-05 ***
log(preretail + 1)          -0.051352   0.014270  -3.599 0.000322 ***
log(pregas + 1)             -0.020833   0.010636  -1.959 0.050174 .  
log(prefood + 1):particpate -0.047840   0.011646  -4.108 4.03e-05 ***
log(prebank + 1):particpate -0.026304   0.009950  -2.644 0.008216 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.8224 on 9883 degrees of freedom
Multiple R-squared:  0.03075,	Adjusted R-squared:  0.02997 
F-statistic:  39.2 on 8 and 9883 DF,  p-value: < 2.2e-16

> plot(im12)
> 
> yhat=predict(im11, purchaseValidation);
> mean((log(purchaseValidation$totalRatio+1)-yhat)^2);
[1] 0.6463436
> 
> yhat=predict(im12, purchaseValidation);
> mean((log(purchaseValidation$totalRatio+1)-yhat)^2);
[1] 0.6498865
> 
> # im11
> # lm(formula = log(totalRatio + 1) ~ log(prefood + 1) + I(log(prebank +
> #     1)^2) + I(log(preother + 1)^2) + particpate + I(log(preretail +
> #     1)^2) + log(prebank + 1) + I(log(pregas + 1)^2) + log(preretail +
> #     1) + log(preother + 1) + log(pregas + 1) + I(log(prefood +
> #     1)^2) + log(prefood + 1):particpate + particpate:log(prebank +
> #     1), data = purchaseTraining)
> 
> # im12
> # lm(formula = log(totalRatio + 1) ~ log(prefood + 1) + log(prebank +
> #     1) + particpate + log(preother + 1) + log(preretail + 1) +
> #     log(pregas + 1) + log(prefood + 1):particpate + log(prebank +
> #     1):particpate, data = purchaseTraining)
> 
> proc.time()
   user  system elapsed 
  3.192   0.136   4.085 
